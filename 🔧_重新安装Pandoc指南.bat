@echo off
chcp 65001 > nul
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘        Pandoc é‡æ–°å®‰è£…æŒ‡å—                        â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo ğŸ“‹ æ£€æŸ¥å½“å‰çŠ¶æ€...
echo.

where pandoc >nul 2>&1
if %errorlevel% equ 0 (
    echo âœ… Pandoc å·²å®‰è£…å¹¶å¯ç”¨ï¼
    echo.
    pandoc --version
    echo.
    echo ğŸš€ å¯ä»¥ç›´æ¥è¿è¡Œæ‰¹é‡è½¬æ¢äº†ï¼
    echo.
    set /p run="æ˜¯å¦ç«‹å³å¼€å§‹æ‰¹é‡è½¬æ¢ï¼Ÿ(Y/N): "
    if /i "!run!"=="Y" (
        call "ğŸ“„_æ‰¹é‡è½¬æ¢MDä¸ºPDF.bat"
    )
    exit /b 0
)

echo âŒ Pandoc æœªæ­£ç¡®å®‰è£…
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    å¯èƒ½çš„åŸå› ï¼š
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo 1. ä¸‹è½½çš„æ˜¯é”™è¯¯çš„ç‰ˆæœ¬ï¼ˆ.deb è€Œä¸æ˜¯ .msiï¼‰
echo 2. å®‰è£…è¿‡ç¨‹ä¸­æ–­æˆ–å¤±è´¥
echo 3. ç¯å¢ƒå˜é‡æœªæ­£ç¡®é…ç½®
echo 4. éœ€è¦ä»¥ç®¡ç†å‘˜èº«ä»½å®‰è£…
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    è§£å†³æ–¹æ¡ˆï¼š
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo [1] é‡æ–°ä¸‹è½½å¹¶å®‰è£… MSI ç‰ˆæœ¬ï¼ˆæ¨èï¼‰â­
echo [2] æ£€æŸ¥ä¸‹è½½æ–‡ä»¶å¤¹ä¸­çš„å®‰è£…åŒ…
echo [3] ä½¿ç”¨ä¾¿æºç‰ˆï¼ˆZIPï¼Œå…å®‰è£…ï¼‰
echo [4] æ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡
echo [5] å–æ¶ˆ
echo.
set /p choice="è¯·é€‰æ‹© (1-5): "

if "%choice%"=="1" goto reinstall
if "%choice%"=="2" goto check_downloads
if "%choice%"=="3" goto portable
if "%choice%"=="4" goto manual_config
if "%choice%"=="5" goto end

:reinstall
cls
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    é‡æ–°ä¸‹è½½å¹¶å®‰è£…
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ğŸ“¥ å³å°†æ‰“å¼€å®˜æ–¹ä¸‹è½½é¡µé¢
echo.
echo ğŸ“ è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š
echo.
echo 1ï¸âƒ£  åœ¨æ‰“å¼€çš„é¡µé¢ä¸­ï¼Œå‘ä¸‹æ»šåŠ¨åˆ° "Assets" éƒ¨åˆ†
echo.
echo 2ï¸âƒ£  æ‰¾åˆ°å¹¶ç‚¹å‡»è¿™ä¸ªæ–‡ä»¶ï¼ˆæ³¨æ„ï¼šå¿…é¡»æ˜¯è¿™ä¸ªï¼‰ï¼š
echo     âœ… pandoc-3.1.11.1-windows-x86_64.msi
echo.
echo     âŒ ä¸è¦ç‚¹å‡»è¿™äº›ï¼š
echo        pandoc-3.1.11.1-amd64.deb       ï¼ˆLinuxç‰ˆæœ¬ï¼‰
echo        pandoc-3.1.11.1-linux-*.tar.gz  ï¼ˆLinuxç‰ˆæœ¬ï¼‰
echo.
echo 3ï¸âƒ£  ä¸‹è½½å®Œæˆåï¼š
echo     - æ‰¾åˆ°ä¸‹è½½çš„ .msi æ–‡ä»¶
echo     - å³é”®ç‚¹å‡» â†’ "ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"
echo     - ä¸€è·¯ç‚¹å‡»"ä¸‹ä¸€æ­¥"
echo     - ç­‰å¾…å®‰è£…å®Œæˆ
echo.
echo 4ï¸âƒ£  å®‰è£…å®Œæˆåï¼š
echo     - é‡æ–°è¿è¡Œæœ¬è„šæœ¬éªŒè¯
echo.
echo æŒ‰ä»»æ„é”®æ‰“å¼€ä¸‹è½½é¡µé¢...
pause > nul
start https://github.com/jgm/pandoc/releases/latest
goto end

:check_downloads
cls
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    æ£€æŸ¥ä¸‹è½½æ–‡ä»¶å¤¹
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ğŸ“‚ æ­£åœ¨æ‰“å¼€ä¸‹è½½æ–‡ä»¶å¤¹...
explorer "%USERPROFILE%\Downloads"
echo.
echo ğŸ“ è¯·åœ¨ä¸‹è½½æ–‡ä»¶å¤¹ä¸­æŸ¥æ‰¾ï¼š
echo.
echo âœ… æ­£ç¡®çš„æ–‡ä»¶ï¼š
echo    - pandoc-3.1.11.1-windows-x86_64.msi
echo    - pandoc-3.1.11.1-windows-x86_64.zip
echo    - æ–‡ä»¶ååŒ…å« "windows" å’Œ ".msi"
echo.
echo âŒ é”™è¯¯çš„æ–‡ä»¶ï¼š
echo    - pandoc-3.1.11.1-amd64.deb          ï¼ˆLinuxç‰ˆæœ¬ï¼‰
echo    - æ–‡ä»¶ååŒ…å« ".deb" æˆ– "linux"
echo.
echo ğŸ’¡ å¦‚æœæ‰¾åˆ°æ­£ç¡®çš„ .msi æ–‡ä»¶ï¼š
echo    1. å³é”®ç‚¹å‡» â†’ "ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ"
echo    2. æŒ‰ç…§å‘å¯¼å®Œæˆå®‰è£…
echo    3. é‡æ–°è¿è¡Œæœ¬è„šæœ¬éªŒè¯
echo.
echo ğŸ’¡ å¦‚æœåªæ‰¾åˆ° .deb æ–‡ä»¶ï¼š
echo    è¿”å›èœå•é€‰æ‹© [1] é‡æ–°ä¸‹è½½æ­£ç¡®ç‰ˆæœ¬
echo.
pause
goto end

:portable
cls
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    ä½¿ç”¨ä¾¿æºç‰ˆï¼ˆå…å®‰è£…ï¼‰
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ğŸ“¥ ä¸‹è½½ä¾¿æºç‰ˆ ZIP æ–‡ä»¶
echo.
echo ğŸ”— ä¸‹è½½é“¾æ¥ï¼š
echo https://github.com/jgm/pandoc/releases/download/3.1.11.1/pandoc-3.1.11.1-windows-x86_64.zip
echo.
echo ğŸ“ ä½¿ç”¨æ­¥éª¤ï¼š
echo.
echo 1ï¸âƒ£  ä¸‹è½½ ZIP æ–‡ä»¶
echo.
echo 2ï¸âƒ£  è§£å‹åˆ°ï¼šC:\Pandoc
echo     ï¼ˆæˆ–å…¶ä»–æ‚¨å–œæ¬¢çš„ä½ç½®ï¼‰
echo.
echo 3ï¸âƒ£  å°†è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼š
echo     - å³é”®"æ­¤ç”µè„‘" â†’ å±æ€§
echo     - é«˜çº§ç³»ç»Ÿè®¾ç½® â†’ ç¯å¢ƒå˜é‡
echo     - åœ¨"ç³»ç»Ÿå˜é‡"ä¸­æ‰¾åˆ° Path
echo     - ç‚¹å‡»"ç¼–è¾‘" â†’ "æ–°å»º"
echo     - æ·»åŠ ï¼šC:\Pandoc
echo     - ç¡®å®šä¿å­˜
echo.
echo 4ï¸âƒ£  é‡å¯å‘½ä»¤è¡Œï¼Œè¿è¡Œæœ¬è„šæœ¬éªŒè¯
echo.
echo æŒ‰ä»»æ„é”®æ‰“å¼€ä¸‹è½½é¡µé¢...
pause > nul
start https://github.com/jgm/pandoc/releases/download/3.1.11.1/pandoc-3.1.11.1-windows-x86_64.zip
goto end

:manual_config
cls
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    æ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo å¦‚æœPandocå·²å®‰è£…ä½†å‘½ä»¤è¡Œæ— æ³•è¯†åˆ«ï¼Œå¯èƒ½éœ€è¦æ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡
echo.
echo ğŸ“ æ­¥éª¤ï¼š
echo.
echo 1ï¸âƒ£  æŸ¥æ‰¾ pandoc.exe ä½ç½®
echo     å¸¸è§ä½ç½®ï¼š
echo     - C:\Program Files\Pandoc\pandoc.exe
echo     - C:\Users\%USERNAME%\AppData\Local\Pandoc\pandoc.exe
echo.
echo 2ï¸âƒ£  æ·»åŠ åˆ°ç¯å¢ƒå˜é‡
echo     - å³é”®"æ­¤ç”µè„‘" â†’ å±æ€§
echo     - é«˜çº§ç³»ç»Ÿè®¾ç½® â†’ ç¯å¢ƒå˜é‡
echo     - åœ¨"ç³»ç»Ÿå˜é‡"ä¸­æ‰¾åˆ° Path
echo     - ç‚¹å‡»"ç¼–è¾‘" â†’ "æ–°å»º"
echo     - æ·»åŠ åŒ…å« pandoc.exe çš„æ–‡ä»¶å¤¹è·¯å¾„
echo     - ç¡®å®šä¿å­˜
echo.
echo 3ï¸âƒ£  é‡å¯å‘½ä»¤è¡Œ
echo     - å…³é—­æ‰€æœ‰å‘½ä»¤è¡Œçª—å£
echo     - é‡æ–°æ‰“å¼€
echo     - è¿è¡Œï¼špandoc --version
echo.
echo æŒ‰ä»»æ„é”®æ‰“å¼€ç³»ç»Ÿå±æ€§...
pause > nul
rundll32 sysdm.cpl,EditEnvironmentVariables
goto end

:end
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
pause
