<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 24px;
      padding: 40px 30px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    h1 {
      font-size: 28px;
      color: #333;
      margin-bottom: 20px;
    }

    .icon {
      font-size: 80px;
      margin-bottom: 30px;
    }

    .description {
      font-size: 16px;
      color: #666;
      line-height: 1.8;
      margin-bottom: 30px;
    }

    .clear-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 18px 50px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
      transition: all 0.3s ease;
      margin-bottom: 20px;
      width: 100%;
      max-width: 300px;
    }

    .clear-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 32px rgba(102, 126, 234, 0.6);
    }

    .clear-btn:active {
      transform: translateY(-1px);
    }

    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 500;
      display: none;
    }

    .status.success {
      background: #e8f5e9;
      color: #2e7d32;
      border: 2px solid #4caf50;
      display: block;
    }

    .status.error {
      background: #ffebee;
      color: #c62828;
      border: 2px solid #f44336;
      display: block;
    }

    .tips {
      background: #f8f9ff;
      border-radius: 12px;
      padding: 20px;
      margin-top: 30px;
      text-align: left;
    }

    .tips h3 {
      font-size: 18px;
      color: #667eea;
      margin-bottom: 15px;
    }

    .tips ol {
      padding-left: 20px;
    }

    .tips li {
      margin-bottom: 10px;
      line-height: 1.6;
      color: #555;
    }

    .countdown {
      font-size: 14px;
      color: #999;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      .container {
        padding: 30px 20px;
      }

      h1 {
        font-size: 24px;
      }

      .icon {
        font-size: 60px;
      }

      .description {
        font-size: 15px;
      }

      .clear-btn {
        padding: 16px 40px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="icon">ğŸ§¹</div>
    <h1>æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°</h1>
    <div class="description">
      å¦‚æœæ‚¨åœ¨æ‰‹æœºç«¯çœ‹åˆ°çš„å†…å®¹ä¸åå°ä¿®æ”¹ä¸ä¸€è‡´,<br>
      ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ¸…é™¤ç¼“å­˜åé‡æ–°åŠ è½½é¡µé¢ã€‚
    </div>

    <button class="clear-btn" onclick="clearCacheAndReload()">
      ğŸš€ æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°
    </button>

    <div class="status" id="status"></div>
    <div class="countdown" id="countdown"></div>

    <div class="tips">
      <h3>ğŸ’¡ ä½¿ç”¨æç¤º</h3>
      <ol>
        <li><strong>ä»€ä¹ˆæ—¶å€™éœ€è¦æ¸…é™¤ç¼“å­˜?</strong><br>
          åå°ä¿®æ”¹äº†å†…å®¹,ä½†æ‰‹æœºç«¯çœ‹ä¸åˆ°æ›´æ–°æ—¶</li>
        <li><strong>æ¸…é™¤åä¼šä¸¢å¤±æ•°æ®å—?</strong><br>
          ä¸ä¼š!åªæ˜¯æ¸…é™¤æµè§ˆå™¨ç¼“å­˜,åå°æ•°æ®ä¸å—å½±å“</li>
        <li><strong>å¤šä¹…éœ€è¦æ¸…é™¤ä¸€æ¬¡?</strong><br>
          ä¸€èˆ¬ä¸éœ€è¦,åªæœ‰æ›´æ–°å†…å®¹çœ‹ä¸åˆ°æ—¶æ‰æ¸…é™¤</li>
        <li><strong>è¿˜æ˜¯ä¸è¡Œæ€ä¹ˆåŠ?</strong><br>
          å°è¯•å…³é—­æµè§ˆå™¨é‡æ–°æ‰“å¼€,æˆ–ä½¿ç”¨æ— ç—•æ¨¡å¼</li>
      </ol>
    </div>
  </div>

  <script>
    function clearCacheAndReload() {
      const statusEl = document.getElementById('status')
      const countdownEl = document.getElementById('countdown')
      
      try {
        // æ˜¾ç¤ºå¤„ç†ä¸­çŠ¶æ€
        statusEl.className = 'status success'
        statusEl.innerHTML = 'âœ… æ­£åœ¨æ¸…é™¤ç¼“å­˜...'

        // æ¸…é™¤localStorage
        localStorage.clear()
        console.log('âœ… localStorage cleared')

        // æ¸…é™¤sessionStorage
        sessionStorage.clear()
        console.log('âœ… sessionStorage cleared')

        // æ¸…é™¤IndexedDB(å¦‚æœå­˜åœ¨)
        if (window.indexedDB) {
          indexedDB.databases().then(databases => {
            databases.forEach(db => {
              indexedDB.deleteDatabase(db.name)
              console.log(`âœ… IndexedDB ${db.name} cleared`)
            })
          }).catch(err => {
            console.warn('IndexedDBæ¸…é™¤å¤±è´¥:', err)
          })
        }

        // æ¸…é™¤Service Workerç¼“å­˜
        if ('caches' in window) {
          caches.keys().then(names => {
            names.forEach(name => {
              caches.delete(name)
              console.log(`âœ… Cache ${name} cleared`)
            })
          }).catch(err => {
            console.warn('Cacheæ¸…é™¤å¤±è´¥:', err)
          })
        }

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        statusEl.innerHTML = 'âœ… ç¼“å­˜æ¸…é™¤æˆåŠŸ!å³å°†åˆ·æ–°é¡µé¢...'

        // å€’è®¡æ—¶åˆ·æ–°
        let countdown = 3
        countdownEl.style.display = 'block'
        countdownEl.textContent = `${countdown}ç§’åè‡ªåŠ¨åˆ·æ–°...`

        const timer = setInterval(() => {
          countdown--
          if (countdown > 0) {
            countdownEl.textContent = `${countdown}ç§’åè‡ªåŠ¨åˆ·æ–°...`
          } else {
            clearInterval(timer)
            // å¼ºåˆ¶åˆ·æ–°é¡µé¢(ä»æœåŠ¡å™¨è·å–æœ€æ–°å†…å®¹)
            window.location.reload(true)
          }
        }, 1000)

      } catch (error) {
        console.error('æ¸…é™¤ç¼“å­˜å¤±è´¥:', error)
        statusEl.className = 'status error'
        statusEl.innerHTML = `âŒ æ¸…é™¤ç¼“å­˜å¤±è´¥: ${error.message}<br>è¯·æ‰‹åŠ¨æ¸…é™¤æµè§ˆå™¨ç¼“å­˜`
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºç¼“å­˜ä¿¡æ¯
    window.addEventListener('load', () => {
      console.log('ğŸ“Š å½“å‰ç¼“å­˜ä¿¡æ¯:')
      console.log('localStorage items:', localStorage.length)
      console.log('sessionStorage items:', sessionStorage.length)

      // æ˜¾ç¤ºlocalStorageå¤§å°ä¼°ç®—
      let totalSize = 0
      for (let key in localStorage) {
        if (localStorage.hasOwnProperty(key)) {
          totalSize += (localStorage[key].length + key.length) * 2
        }
      }
      console.log('localStorage size:', (totalSize / 1024).toFixed(2), 'KB')
    })
  </script>
</body>
</html>
