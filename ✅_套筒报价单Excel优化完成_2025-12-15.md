# ✅ 套筒选型报价单 Excel 优化完成

---

## 🎯 优化内容总览

### 原版 → 专业报价单格式

| 项目 | 优化前 | 优化后 |
|------|-------|-------|
| 格式 | 简单数据表格 | **专业报价单** |
| 买卖方信息 | ❌ 无 | ✅ 完整信息块 |
| 价格字段 | ❌ 无 | ✅ 不含税/含税/总价 |
| 工具信息 | 只有抗振品牌 | ✅ 品牌+型号+是否抗振 |
| 货期 | ❌ 无 | ✅ 货期(天) |
| 报价信息 | ❌ 无 | ✅ 报价时间+有效期 |
| 合计 | ❌ 无 | ✅ 自动合计 |
| 打印 | ❌ 不便 | ✅ Excel打印功能 |

---

## 📋 新版报价单结构

### **完整布局**

```
┌─────────────────────────────────────────────────────────┐
│              套筒选型报价单                              │
├─────────────────────────────────────────────────────────┤
│ 【买方信息】                                             │
│ 公司名称: ___________  联系人: _______  电话: _________ │
│ 地址: _______________  邮箱: ______________________     │
│ 收货地址: __________________________________________    │
├─────────────────────────────────────────────────────────┤
│ 【卖方信息】                                             │
│ 公司名称: 北京安彤智能科技有限公司                       │
│ 地址: 北京市           联系人: _______  电话: ______   │
│ 邮箱: info@antum.com                                    │
├─────────────────────────────────────────────────────────┤
│ 【产品明细】                                             │
│ 序号│型号│品牌│工具型号│外形│输出端│...│数量│单价│总价│ │
│  1  │xxx │xxx │       │   │     │...│ 2 │ 0 │ 0 │     │
│  2  │xxx │xxx │       │   │     │...│ 1 │ 0 │ 0 │     │
│                                      合计:      0        │
├─────────────────────────────────────────────────────────┤
│ 【报价信息】                                             │
│ 报价时间: 2025-12-15                                    │
│ 报价有效期: 2026-01-14 (默认30天)                       │
│ 备注说明: _____________                                 │
├─────────────────────────────────────────────────────────┤
│ 【应用信息】(如已填写)                                   │
│ 线体名称: xxx                                           │
│ 工位名称: xxx                                           │
└─────────────────────────────────────────────────────────┘
```

---

## 📊 产品明细表格(18列)

| 列名 | 说明 | 默认值 | 可编辑 |
|------|------|--------|--------|
| 序号 | 自动编号 | 1,2,3... | ❌ |
| 套筒型号 | 套筒型号 | AV315150MP | ✅ |
| 工具品牌 | 工具品牌 | 阿特拉斯 | ✅ |
| **工具型号** | 工具型号 | (空) | ✅ 新增 |
| 套筒外形 | 外形 | 标准/加长 | ✅ |
| 输出端类型 | 输出端 | 外六角 | ✅ |
| 输出端尺寸 | 尺寸 | 15mm | ✅ |
| 输入端四方 | 四方 | 1/2 | ✅ |
| 长度 | 长度 | 50mm | ✅ |
| 磁性类型 | 磁性 | 固定磁 | ✅ |
| **是否抗振** | 是/否 | 是 | ✅ 新增 |
| 特殊要求 | 其他要求 | 密封圈 | ✅ |
| 数量 | 数量 | 2 | ✅ |
| **单价(不含税)** | 单价 | 0 | ✅ 新增 |
| **单价(含税)** | 含税价 | 0 | ✅ 新增 |
| **总价** | 自动计算 | 0 | ✅ 新增 |
| **货期(天)** | 交货期 | (空) | ✅ 新增 |
| 备注 | 备注 | (空) | ✅ |

---

## 💰 价格计算逻辑

### 自动计算公式(Excel 中可修改)

```
总价 = 单价(含税) × 数量
合计 = 所有总价之和
```

### 使用流程

1. **生成报价单**: 价格字段默认为 0
2. **打开 Excel**: 手动填写单价
3. **自动计算**: 修改单价或数量,总价自动更新
4. **查看合计**: 底部显示总金额

---

## 📅 报价信息

### 报价时间
- 自动生成当前日期
- 格式: `2025-12-15`

### 报价有效期
- 自动计算(默认30天后)
- 格式: `2026-01-14`
- 可在 Excel 中手动修改

### 备注说明
- 空白单元格
- 可填写付款方式、交货条件等

---

## 🏢 买卖方信息

### 买方信息(需手动填写)
- ✅ 公司名称
- ✅ 联系人
- ✅ 电话
- ✅ 地址
- ✅ 邮箱
- ✅ 收货地址

### 卖方信息(预填)
- ✅ 公司名称: 北京安彤智能科技有限公司
- ✅ 地址: 北京市
- ✅ 邮箱: info@antum.com
- ⚠️ 联系人/电话: 需手动补充

---

## 🖨️ 打印功能

### 在 Excel 中打印

1. **打开生成的 Excel 文件**
2. 点击 `文件` → `打印`
3. 选择打印机
4. 调整页面设置:
   - 方向: 横向
   - 缩放: 调整至一页
   - 边距: 窄边距
5. **打印预览**
6. 点击 `打印`

### 导出 PDF(推荐)

1. 打开 Excel 文件
2. 点击 `文件` → `另存为`
3. 文件类型选择: `PDF`
4. 保存

**优势**:
- ✅ 格式固定不变
- ✅ 方便邮件发送
- ✅ 防止修改

---

## 📐 Excel 格式设置

### 列宽(已自动设置)

| 列 | 宽度 | 说明 |
|----|------|------|
| 序号 | 6 | 够显示3位数 |
| 套筒型号 | 16 | 完整显示型号 |
| 工具品牌 | 14 | 品牌名称 |
| 工具型号 | 14 | 工具型号 |
| 单价/总价 | 12-14 | 显示价格 |
| 备注 | 20 | 详细说明 |

### 单元格合并

- ✅ 标题行合并(A1:R1)
- ✅ 买方信息标题合并
- ✅ 卖方信息标题合并
- ✅ 产品明细标题合并

### 行高

- 标题行: 30pt (更醒目)
- 其他行: 默认

---

## 🎨 使用示例

### 示例数据

**产品明细**:

| 序号 | 套筒型号 | 工具品牌 | 工具型号 | 数量 | 单价(不含税) | 单价(含税) | 总价 | 货期 |
|------|---------|---------|---------|------|-------------|-----------|------|------|
| 1 | AV315150MP | 阿特拉斯 | ETBP45-10 | 2 | 75.00 | 85.00 | 170.00 | 7 |
| 2 | TEST001 | 其他 | MANUAL | 1 | 100.00 | 113.00 | 113.00 | 14 |
| **合计** | | | | | | | **283.00** | |

**报价信息**:
- 报价时间: 2025-12-15
- 报价有效期: 2026-01-14
- 备注: 含运费,款到发货

---

## 🔄 工作流程

### 1. 前台配置

```
工具选型页面
  ↓
填写套筒参数(型号/数量/规格等)
  ↓
点击 [生成报价单(Excel)]
  ↓
下载 Excel 文件
```

### 2. Excel 编辑

```
打开 Excel
  ↓
填写买方信息(公司/联系人/地址等)
  ↓
填写单价(不含税/含税)
  ↓
填写货期(天数)
  ↓
检查总价合计
  ↓
补充备注说明
```

### 3. 交付客户

```
方式1: 直接打印 → 盖章 → 快递
方式2: 导出PDF → 电子签章 → 邮件发送
方式3: Excel原文件 → 加密 → 邮件发送
```

---

## 🆕 新增字段说明

### 1. 工具型号
- **位置**: 产品明细第4列
- **用途**: 记录配套工具型号
- **示例**: ETBP45-10, HBP45-20

### 2. 是否抗振
- **位置**: 产品明细第11列
- **值**: 是/否
- **自动判断**: 根据"特殊要求"中是否包含"抗振"

### 3. 单价(不含税)
- **位置**: 产品明细第14列
- **默认**: 0
- **用途**: 记录不含税单价

### 4. 单价(含税)
- **位置**: 产品明细第15列
- **默认**: 0
- **用途**: 记录含税单价,用于计算总价

### 5. 总价
- **位置**: 产品明细第16列
- **计算**: 单价(含税) × 数量
- **合计**: 自动在底部显示

### 6. 货期(天)
- **位置**: 产品明细第17列
- **默认**: 空
- **用途**: 记录交货周期(天数)

---

## ⚙️ 技术实现

### 数据结构

```javascript
const excelData = [
  ['套筒选型报价单'],            // 标题
  [],                            // 空行
  ['买方信息'],                  // 买方信息块
  ['公司名称', '', '', '联系人', '', '电话'],
  ...,
  ['卖方信息'],                  // 卖方信息块
  ['公司名称', '北京安彤智能科技有限公司', ...],
  ...,
  ['产品明细'],                  // 产品表头
  ['序号', '套筒型号', ...],
  [1, 'AV315150MP', ...],        // 产品数据
  ['', '', ..., '合计', '', '', totalAmount],
  [],
  ['报价信息'],                  // 报价信息
  ['报价时间', '2025-12-15'],
  ['报价有效期', '2026-01-14'],
]
```

### 单元格合并

```javascript
const merges = [
  { s: { r: 0, c: 0 }, e: { r: 0, c: 17 } }, // 标题
  { s: { r: 2, c: 0 }, e: { r: 2, c: 5 } },  // 买方信息标题
  { s: { r: 9, c: 0 }, e: { r: 9, c: 5 } },  // 卖方信息标题
  { s: { r: 13, c: 0 }, e: { r: 13, c: 17 } } // 产品明细标题
]
```

### 自动计算

```javascript
const unitPriceWithTax = 0  // 含税单价
const quantity = socket.quantity || 1
const total = unitPriceWithTax * quantity
totalAmount += total
```

---

## 📝 使用建议

### 内部使用
1. **快速报价**: 填写单价后立即发送
2. **成本核算**: 记录不含税单价便于核算
3. **版本管理**: 文件名含时间戳,便于追溯

### 客户沟通
1. **正式报价**: 填写完整后导出PDF
2. **价格谈判**: Excel 格式便于调整
3. **订单确认**: 打印盖章作为合同附件

### 档案管理
1. **按客户**: 创建客户文件夹保存
2. **按项目**: 一个项目可能多次报价
3. **编号规则**: 建议加上报价编号

---

## 🎯 快速测试

### 步骤 1: 配置套筒

1. 套筒型号: AV315150MP
2. 工具品牌: 阿特拉斯
3. 数量: 2
4. 其他参数随意

### 步骤 2: 生成报价单

1. 点击 `[生成报价单(Excel)]`
2. 下载文件

### 步骤 3: 打开编辑

1. 打开 Excel
2. 填写买方信息
3. 填写单价: 85.00
4. 查看总价: 170.00
5. 填写货期: 7

### 步骤 4: 导出打印

1. 调整格式(可选)
2. 文件 → 另存为 → PDF
3. 或直接打印

---

## 🎉 完成状态

| 功能 | 状态 | 说明 |
|------|------|------|
| 买方信息 | ✅ | 6个字段(公司/联系人/电话/地址/邮箱/收货地址) |
| 卖方信息 | ✅ | 预填公司信息 |
| 工具品牌 | ✅ | 原"抗振品牌"改名 |
| 工具型号 | ✅ | 新增列 |
| 是否抗振 | ✅ | 新增列,自动判断 |
| 单价(不含税) | ✅ | 新增列 |
| 单价(含税) | ✅ | 新增列 |
| 总价 | ✅ | 自动计算 |
| 货期 | ✅ | 新增列 |
| 合计 | ✅ | 自动合计 |
| 报价时间 | ✅ | 自动生成 |
| 报价有效期 | ✅ | 自动计算(30天) |
| 单元格合并 | ✅ | 标题/信息块合并 |
| 列宽优化 | ✅ | 18列宽度自动设置 |
| 打印支持 | ✅ | Excel原生打印功能 |
| PDF导出 | ✅ | Excel另存为PDF |

---

**专业报价单格式完成,可直接用于商务报价!** 🎉
