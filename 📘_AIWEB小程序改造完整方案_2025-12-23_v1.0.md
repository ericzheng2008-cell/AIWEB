# 📱 AIWEB小程序改造完整方案

> **版本：** v1.0  
> **日期：** 2025-12-23  
> **项目：** 明升企业智能体 AIWEB → 微信小程序  
> **目标：** 将现有Vue3 Web应用改造为微信小程序，实现移动端智能化办公

---

## 📋 目录

- [第一部分：详细开发方案](#第一部分详细开发方案)
  - [1.1 技术选型与架构设计](#11-技术选型与架构设计)
  - [1.2 开发路线图（6周计划）](#12-开发路线图6周计划)
  - [1.3 核心功能改造清单](#13-核心功能改造清单)
  - [1.4 技术难点与解决方案](#14-技术难点与解决方案)
- [第二部分：服务器部署指南](#第二部分服务器部署指南)
  - [2.1 腾讯云服务购买配置](#21-腾讯云服务购买配置)
  - [2.2 后端API服务部署](#22-后端api服务部署)
  - [2.3 数据库配置](#23-数据库配置)
  - [2.4 域名备案与SSL证书](#24-域名备案与ssl证书)
- [第三部分：运营推广策略](#第三部分运营推广策略)
  - [3.1 小程序注册发布流程](#31-小程序注册发布流程)
  - [3.2 推广渠道与策略](#32-推广渠道与策略)
  - [3.3 用户增长方案](#33-用户增长方案)
  - [3.4 数据监控与优化](#34-数据监控与优化)

---

## 第一部分：详细开发方案

### 1.1 技术选型与架构设计

#### 🎯 推荐技术栈

| 技术层 | Web端（现状） | 小程序端（目标） | 理由 |
|--------|---------------|------------------|------|
| **前端框架** | Vue 3.4 | uni-app（Vue 3） | ✅ 一套代码多端运行<br>✅ 熟悉的Vue语法<br>✅ 丰富的UI组件库 |
| **UI组件库** | Element Plus | uView Plus 3.0 | ✅ 专为uni-app设计<br>✅ 完整的微信小程序适配<br>✅ 现代化设计风格 |
| **状态管理** | Pinia | Pinia | ✅ 完全复用现有代码<br>✅ uni-app原生支持 |
| **路由管理** | Vue Router | uni-app Pages | ✅ 配置式路由管理<br>✅ 原生小程序体验 |
| **HTTP请求** | Axios | uni.request + 拦截器 | ✅ 小程序环境适配<br>✅ 完整的错误处理 |
| **图表库** | ECharts | uCharts + ECharts H5 | ✅ 轻量级高性能<br>✅ 支持复杂图表渲染 |
| **多语言** | Vue I18n | Vue I18n | ✅ 直接复用现有翻译 |

#### 🏗️ 架构对比

**现有Web架构：**
```
AIWEB (Web)
├── Frontend (Vue 3 + Vite)
│   ├── Element Plus UI
│   ├── Vue Router
│   ├── Pinia Store
│   ├── ECharts/ECharts-GL
│   └── Axios HTTP
└── Backend (Express.js)
    ├── SQLite Database
    ├── JWT Auth
    └── File Upload (Multer)
```

**小程序架构设计：**
```
AIWEB (Mini Program)
├── Frontend (uni-app + Vue 3)
│   ├── uView Plus UI
│   ├── Pages Config Router
│   ├── Pinia Store (复用)
│   ├── uCharts + ECharts H5
│   └── uni.request HTTP
├── Backend API (Express.js - 复用)
│   ├── 云数据库 (MySQL/MongoDB)
│   ├── 微信登录 (wx.login)
│   ├── 云存储 (对象存储COS)
│   └── 云函数 (可选)
└── 微信开放平台
    ├── 微信授权登录
    ├── 模板消息推送
    └── 微信支付(可选)
```

---

### 1.2 开发路线图（6周计划）

#### 📅 Week 1：环境搭建与核心框架迁移

**目标：** 完成uni-app基础框架搭建，迁移核心配置

**任务清单：**

- [ ] **Day 1-2：环境准备**
  - 安装HBuilderX IDE（uni-app官方开发工具）
  - 创建uni-app项目（选择Vue 3模板）
  - 配置微信小程序开发者工具
  - 申请微信小程序账号（企业认证）
  
- [ ] **Day 3-4：基础框架迁移**
  - 安装uView Plus 3.0组件库
  - 配置Pinia状态管理（复用现有Store）
  - 配置pages.json路由（映射现有Router）
  - 配置多语言系统（复用i18n）
  
- [ ] **Day 5-7：核心工具类适配**
  - 改造Axios为uni.request
  - 封装HTTP拦截器（Token、错误处理）
  - 改造文件上传逻辑（使用uni.uploadFile）
  - 配置环境变量（开发/生产）

**交付物：**
- ✅ uni-app基础项目框架
- ✅ 小程序开发环境配置完成
- ✅ HTTP请求封装完成
- ✅ 基础UI组件库集成

---

#### 📅 Week 2：核心页面适配（首页+智能体中心）

**目标：** 完成首页、智能体卡片、导航栏的小程序适配

**任务清单：**

- [ ] **Day 1-2：首页改造**
  - 适配Home.vue为小程序页面
  - 重构Banner轮播（使用swiper组件）
  - 改造明星产品卡片布局
  - 适配响应式设计为rpx单位
  
- [ ] **Day 3-4：智能体中心**
  - 迁移AgentHub.vue
  - 改造智能体卡片样式
  - 适配卡片点击交互
  - 实现智能体分类筛选
  
- [ ] **Day 5-6：导航与底部Tab**
  - 配置小程序原生TabBar
  - 设计底部导航菜单（首页/智能体/我的）
  - 适配顶部导航栏
  - 实现语言切换功能
  
- [ ] **Day 7：用户中心页面**
  - 创建"我的"页面
  - 实现微信授权登录
  - 显示用户信息
  - 设置菜单入口

**交付物：**
- ✅ 首页完整功能
- ✅ 智能体中心页面
- ✅ 底部导航栏
- ✅ 微信登录功能

---

#### 📅 Week 3：核心智能体功能迁移

**目标：** 迁移AICRM、工作流、套筒选型等核心智能体

**任务清单：**

- [ ] **Day 1-2：明升AICRM**
  - 客户360画像页面适配
  - 客户联系人管理
  - 商机漏斗图表（uCharts）
  - 投标预测AI模拟
  
- [ ] **Day 3-4：工作流智能体**
  - 工作流列表页面
  - 工作流详情查看（简化节点编辑）
  - 执行记录查看
  - 移动端优化（只读模式优先）
  
- [ ] **Day 5-6：套筒选型工具**
  - 拧紧参数输入表单
  - 套筒推荐算法（复用）
  - 报价单生成（PDF/图片分享）
  - 选型历史记录
  
- [ ] **Day 7：数据可视化**
  - ECharts图表适配（使用lime-echart组件）
  - 3D图表改为2D（性能优化）
  - 数据筛选器适配
  - 导出功能（图片/分享）

**交付物：**
- ✅ AICRM核心功能
- ✅ 工作流查看功能
- ✅ 套筒选型工具
- ✅ 数据图表展示

---

#### 📅 Week 4：AI对话与内容管理

**目标：** 实现AI聊天机器人、小课堂、知识库功能

**任务清单：**

- [ ] **Day 1-2：AI聊天机器人**
  - 聊天界面适配（scroll-view）
  - 消息气泡样式
  - 语音输入（使用wx.startRecord）
  - 消息推送通知
  
- [ ] **Day 3-4：产品技术小课堂**
  - 课程列表页面
  - 课程详情（支持视频播放）
  - 课程收藏功能
  - 学习进度记录
  
- [ ] **Day 5-6：知识库管理**
  - 知识库分类展示
  - 文档在线预览
  - 搜索功能
  - 下载/分享功能
  
- [ ] **Day 7：产品与服务**
  - 产品多级分类
  - 产品详情页
  - 询盘表单提交
  - 产品收藏/分享

**交付物：**
- ✅ AI聊天功能
- ✅ 小课堂完整功能
- ✅ 知识库查看
- ✅ 产品展示

---

#### 📅 Week 5：后台管理与权限系统

**目标：** 移动端后台管理功能，支持简单内容编辑

**任务清单：**

- [ ] **Day 1-2：权限管理**
  - 角色权限配置
  - 管理员登录（手机号+验证码）
  - 页面权限控制
  - 数据权限过滤
  
- [ ] **Day 3-4：内容发布（简化版）**
  - Banner图管理
  - 明星产品编辑
  - 小课堂课程上传
  - 图片选择与上传
  
- [ ] **Day 5-6：数据统计**
  - 用户访问统计
  - 功能使用热力图
  - 销售漏斗数据
  - 导出报表
  
- [ ] **Day 7：系统设置**
  - 企业信息编辑
  - 联系方式管理
  - 版本更新提示
  - 关于页面

**交付物：**
- ✅ 移动端后台管理
- ✅ 内容发布功能
- ✅ 数据统计报表
- ✅ 系统设置

---

#### 📅 Week 6：性能优化与测试发布

**目标：** 全面测试、性能优化、提交审核

**任务清单：**

- [ ] **Day 1-2：性能优化**
  - 分包加载（主包<2MB）
  - 图片懒加载
  - 组件按需加载
  - 缓存策略优化
  
- [ ] **Day 3-4：全面测试**
  - 功能测试（每个页面）
  - 兼容性测试（iOS/Android）
  - 性能测试（加载速度）
  - 用户体验测试
  
- [ ] **Day 5：体验优化**
  - 加载动画优化
  - 错误提示优化
  - 交互反馈优化
  - 无网络状态处理
  
- [ ] **Day 6-7：发布准备**
  - 配置隐私协议
  - 配置服务器域名
  - 上传代码审核
  - 准备审核资料

**交付物：**
- ✅ 性能优化完成
- ✅ 全部功能测试通过
- ✅ 小程序提交审核
- ✅ 发布上线

---

### 1.3 核心功能改造清单

#### 🔧 功能优先级划分

**P0（核心必做）：**

1. ✅ **用户系统**
   - 微信授权登录
   - 用户信息管理
   - 权限控制

2. ✅ **首页展示**
   - Banner轮播
   - 明星产品
   - 智能体卡片

3. ✅ **核心智能体**
   - 明升AICRM客户管理
   - 套筒选型工具
   - AI聊天机器人

4. ✅ **产品与服务**
   - 产品分类浏览
   - 产品详情
   - 询盘提交

**P1（重要功能）：**

1. ✅ **工作流系统**
   - 工作流列表
   - 工作流执行记录
   - 简化版编辑器（只读模式）

2. ✅ **数据统计**
   - 商机漏斗
   - 销售目标
   - 设备运营大脑

3. ✅ **内容中心**
   - 产品技术小课堂
   - 知识库
   - 文档下载

**P2（增强功能）：**

1. ✅ **社交分享**
   - 产品分享
   - 报价单分享
   - 课程分享

2. ✅ **消息推送**
   - 模板消息
   - 订阅消息
   - 客服消息

3. ✅ **移动端后台**
   - 简易内容编辑
   - 数据查看
   - 快捷操作

---

### 1.4 技术难点与解决方案

#### 🚧 难点1：ECharts 3D图表适配

**问题：**
- 小程序不支持ECharts-GL
- 3D驾驶舱效果无法直接渲染

**解决方案：**
```javascript
// 方案A：降级为2D图表
// 使用lime-echart组件（支持ECharts 5.x）
<lime-echart ref="chart" :echarts="echarts" :option="chartOption" />

// 方案B：使用Canvas 2D绘制3D效果
// 采用伪3D效果（投影、渐变、动画）
const option = {
  series: [{
    type: 'bar3D', // 改为 bar
    barWidth: 20,
    itemStyle: {
      opacity: 0.8,
      color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
        { offset: 0, color: '#4e79ff' },
        { offset: 1, color: '#1a3fff' }
      ])
    }
  }]
}

// 方案C：关键3D图表使用WebView嵌入H5
<web-view src="https://api.yourserver.com/3d-chart?id=xxx" />
```

**推荐：** 方案A（大部分图表） + 方案C（核心3D驾驶舱）

---

#### 🚧 难点2：Element Plus组件替换

**问题：**
- Element Plus不支持小程序
- 大量组件需要重新适配

**解决方案：**

| Element Plus | uView Plus 3.0 | 迁移难度 |
|--------------|----------------|----------|
| el-button | u-button | ⭐ 简单 |
| el-input | u-input | ⭐ 简单 |
| el-dialog | u-modal | ⭐⭐ 中等 |
| el-table | u-table | ⭐⭐⭐ 复杂 |
| el-upload | u-upload | ⭐⭐⭐ 复杂 |
| el-date-picker | u-datetime-picker | ⭐⭐ 中等 |
| el-select | u-picker | ⭐⭐ 中等 |

**迁移示例：**

```vue
<!-- Web端 (Element Plus) -->
<el-button type="primary" @click="handleClick">
  提交
</el-button>

<!-- 小程序端 (uView Plus) -->
<u-button type="primary" @click="handleClick">
  提交
</u-button>

<!-- 复杂组件迁移示例：表格 -->
<!-- Web端 -->
<el-table :data="tableData">
  <el-table-column prop="name" label="姓名" />
  <el-table-column prop="age" label="年龄" />
</el-table>

<!-- 小程序端 -->
<u-table>
  <u-tr v-for="item in tableData" :key="item.id">
    <u-td>{{ item.name }}</u-td>
    <u-td>{{ item.age }}</u-td>
  </u-tr>
</u-table>
```

---

#### 🚧 难点3：文件上传与存储

**问题：**
- 小程序文件上传需要特殊处理
- 无法直接使用Multer

**解决方案：**

**前端（小程序）：**
```javascript
// utils/upload.js
export const uploadFile = (filePath) => {
  return new Promise((resolve, reject) => {
    uni.uploadFile({
      url: `${baseURL}/api/upload`,
      filePath: filePath,
      name: 'file',
      header: {
        'Authorization': `Bearer ${getToken()}`
      },
      success: (res) => {
        const data = JSON.parse(res.data)
        resolve(data.url)
      },
      fail: reject
    })
  })
}

// 使用示例
uni.chooseImage({
  count: 1,
  success: async (res) => {
    const url = await uploadFile(res.tempFilePaths[0])
    console.log('上传成功:', url)
  }
})
```

**后端（Express.js）：**
```javascript
// 保持现有Multer配置，支持小程序
router.post('/upload', upload.single('file'), (req, res) => {
  res.json({
    success: true,
    url: `/uploads/${req.file.filename}`
  })
})
```

**云存储方案（推荐）：**
```javascript
// 使用腾讯云COS对象存储
import COS from 'cos-js-sdk-v5'

const cos = new COS({
  SecretId: 'YOUR_SECRET_ID',
  SecretKey: 'YOUR_SECRET_KEY'
})

// 直传到COS（减轻服务器压力）
const uploadToCOS = (filePath) => {
  return new Promise((resolve, reject) => {
    cos.postObject({
      Bucket: 'your-bucket',
      Region: 'ap-guangzhou',
      Key: `uploads/${Date.now()}.jpg`,
      FilePath: filePath,
      onProgress: (info) => {
        console.log('上传进度:', info.percent)
      }
    }, (err, data) => {
      if (err) reject(err)
      else resolve(data.Location)
    })
  })
}
```

---

#### 🚧 难点4：路由与页面跳转

**问题：**
- Vue Router不支持小程序
- 需要改用uni-app的页面跳转API

**解决方案：**

**配置pages.json：**
```json
{
  "pages": [
    {
      "path": "pages/index/index",
      "style": {
        "navigationBarTitleText": "首页"
      }
    },
    {
      "path": "pages/agents/index",
      "style": {
        "navigationBarTitleText": "智能体中心"
      }
    },
    {
      "path": "pages/aicrm/customer-detail",
      "style": {
        "navigationBarTitleText": "客户详情"
      }
    }
  ],
  "tabBar": {
    "color": "#999999",
    "selectedColor": "#5755d9",
    "list": [
      {
        "pagePath": "pages/index/index",
        "iconPath": "static/tab/home.png",
        "selectedIconPath": "static/tab/home-active.png",
        "text": "首页"
      },
      {
        "pagePath": "pages/agents/index",
        "iconPath": "static/tab/agents.png",
        "selectedIconPath": "static/tab/agents-active.png",
        "text": "智能体"
      },
      {
        "pagePath": "pages/user/index",
        "iconPath": "static/tab/user.png",
        "selectedIconPath": "static/tab/user-active.png",
        "text": "我的"
      }
    ]
  }
}
```

**路由跳转封装：**
```javascript
// utils/router.js
export const navigateTo = (url, params = {}) => {
  const query = Object.keys(params)
    .map(key => `${key}=${encodeURIComponent(params[key])}`)
    .join('&')
  
  uni.navigateTo({
    url: query ? `${url}?${query}` : url
  })
}

// 使用示例
// Web端：this.$router.push({ name: 'CustomerDetail', params: { id: 123 } })
// 小程序端：navigateTo('/pages/aicrm/customer-detail', { id: 123 })
```

---

#### 🚧 难点5：全局状态管理（Pinia）

**问题：**
- Pinia在uni-app中需要特殊配置

**解决方案：**

**main.js配置：**
```javascript
import { createSSRApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'

export function createApp() {
  const app = createSSRApp(App)
  const pinia = createPinia()
  
  app.use(pinia)
  
  return { app }
}
```

**Store复用示例：**
```javascript
// stores/user.js（可直接复用Web端代码）
import { defineStore } from 'pinia'

export const useUserStore = defineStore('user', {
  state: () => ({
    userInfo: null,
    token: uni.getStorageSync('token') || ''
  }),
  
  actions: {
    // 小程序登录
    async wxLogin(code) {
      const res = await uni.request({
        url: '/api/wx/login',
        method: 'POST',
        data: { code }
      })
      
      this.token = res.data.token
      this.userInfo = res.data.userInfo
      uni.setStorageSync('token', this.token)
    },
    
    // 退出登录
    logout() {
      this.token = ''
      this.userInfo = null
      uni.removeStorageSync('token')
    }
  }
})
```

---

## 第二部分：服务器部署指南

### 2.1 腾讯云服务购买配置

#### 🛒 推荐配置方案

**方案A：入门版（测试/小规模）**

| 服务 | 规格 | 价格 | 用途 |
|------|------|------|------|
| 云服务器CVM | 2核4G，5M带宽 | ¥99/月 | 后端API服务 |
| 云数据库MySQL | 1核1G，20GB存储 | ¥50/月 | 数据存储 |
| 对象存储COS | 50GB标准存储 | ¥6/月 | 图片/文件存储 |
| SSL证书 | 免费DV证书 | ¥0 | HTTPS支持 |
| **合计** | - | **¥155/月** | - |

**方案B：标准版（推荐）**

| 服务 | 规格 | 价格 | 用途 |
|------|------|------|------|
| 云服务器CVM | 4核8G，8M带宽 | ¥199/月 | 后端API服务 |
| 云数据库MySQL | 2核4G，100GB存储 | ¥180/月 | 数据存储 |
| 对象存储COS | 200GB标准存储 | ¥24/月 | 图片/文件存储 |
| CDN加速 | 100GB流量包 | ¥20/月 | 静态资源加速 |
| SSL证书 | 免费DV证书 | ¥0 | HTTPS支持 |
| **合计** | - | **¥423/月** | - |

**方案C：企业版（高并发）**

| 服务 | 规格 | 价格 | 用途 |
|------|------|------|------|
| 云服务器CVM | 8核16G，10M带宽 | ¥499/月 | 后端API服务 |
| 负载均衡CLB | 标准实例 | ¥30/月 | 高可用 |
| 云数据库MySQL | 4核8G，500GB存储 | ¥580/月 | 数据存储 |
| Redis缓存 | 1GB标准版 | ¥50/月 | 会话/缓存 |
| 对象存储COS | 1TB标准存储 | ¥120/月 | 图片/文件存储 |
| CDN加速 | 500GB流量包 | ¥85/月 | 静态资源加速 |
| SSL证书 | OV企业证书 | ¥1500/年 | HTTPS支持 |
| **合计** | - | **¥1489/月** | - |

---

#### 📝 详细购买步骤

**Step 1：注册腾讯云账号**

1. 访问 https://cloud.tencent.com
2. 点击"免费注册"
3. 完成企业实名认证（需要营业执照）
4. 领取新用户代金券（通常可领¥2000+）

**Step 2：购买云服务器CVM**

1. 进入云服务器CVM控制台
2. 点击"新建"
3. 配置选择：
   - **地域：** 选择靠近用户的地域（如华南-广州）
   - **机型：** 标准型S5（推荐）
   - **规格：** 4核8G（根据方案选择）
   - **镜像：** CentOS 7.9 或 Ubuntu 20.04
   - **系统盘：** 50GB SSD云硬盘
   - **网络：** 按固定带宽，8Mbps
   - **安全组：** 放通22、80、443、5000端口
4. 购买时长：建议1年（有折扣）
5. 设置root密码
6. 点击"立即购买"

**Step 3：购买云数据库MySQL**

1. 进入云数据库MySQL控制台
2. 点击"新建"
3. 配置选择：
   - **地域：** 与CVM相同
   - **规格：** 2核4G，100GB存储
   - **版本：** MySQL 5.7或8.0
   - **网络：** 选择与CVM相同的VPC
   - **字符集：** utf8mb4
   - **端口：** 3306
4. 设置root密码（强密码）
5. 点击"立即购买"

**Step 4：购买对象存储COS**

1. 进入对象存储COS控制台
2. 创建存储桶：
   - **名称：** aiweb-miniprogram-1234567890
   - **地域：** 与CVM相同
   - **访问权限：** 私有读写（通过签名URL访问）
3. 配置跨域CORS：
   ```json
   {
     "AllowedOrigins": ["*"],
     "AllowedMethods": ["GET", "POST", "PUT"],
     "AllowedHeaders": ["*"],
     "ExposeHeaders": [],
     "MaxAgeSeconds": 3600
   }
   ```
4. 购买资源包（可选，按量付费更灵活）

**Step 5：申请SSL证书**

1. 进入SSL证书控制台
2. 点击"申请免费证书"
3. 填写域名（如：api.yourcompany.com）
4. 选择DNS验证或文件验证
5. 完成验证后下载证书（Nginx格式）

---

### 2.2 后端API服务部署

#### 🚀 服务器环境配置

**连接服务器：**
```bash
# 使用SSH连接（Mac/Linux）
ssh root@你的服务器IP

# Windows用户使用PuTTY或Xshell
```

**安装必要软件：**
```bash
# 更新系统
yum update -y  # CentOS
# 或
apt update && apt upgrade -y  # Ubuntu

# 安装Node.js 18
curl -fsSL https://rpm.nodesource.com/setup_18.x | bash -
yum install -y nodejs

# 验证安装
node -v  # 应显示 v18.x.x
npm -v

# 安装PM2进程管理器
npm install -g pm2

# 安装Nginx
yum install -y nginx  # CentOS
# 或
apt install -y nginx  # Ubuntu

# 启动Nginx
systemctl start nginx
systemctl enable nginx
```

---

#### 📦 部署后端代码

**Step 1：上传代码**

方法A：使用Git（推荐）
```bash
# 在服务器上
cd /var/www
git clone https://github.com/yourcompany/aiweb-backend.git
cd aiweb-backend
```

方法B：使用FTP/SFTP工具
- 推荐工具：FileZilla、WinSCP
- 上传server目录到 `/var/www/aiweb-backend`

**Step 2：安装依赖**
```bash
cd /var/www/aiweb-backend
npm install --production
```

**Step 3：配置环境变量**
```bash
# 创建.env文件
nano .env

# 填入以下内容
NODE_ENV=production
PORT=5000

# 数据库配置（使用腾讯云MySQL）
DB_HOST=你的MySQL内网IP
DB_PORT=3306
DB_USER=root
DB_PASSWORD=你的MySQL密码
DB_DATABASE=aiweb_miniprogram

# JWT密钥
JWT_SECRET=your-super-secret-key-change-this

# 微信小程序配置
WX_APPID=你的小程序AppID
WX_SECRET=你的小程序AppSecret

# 腾讯云COS配置
COS_SECRET_ID=你的SecretId
COS_SECRET_KEY=你的SecretKey
COS_BUCKET=aiweb-miniprogram-1234567890
COS_REGION=ap-guangzhou

# 保存并退出（Ctrl+X，Y，Enter）
```

**Step 4：初始化数据库**
```bash
# 连接到MySQL
mysql -h你的MySQL内网IP -uroot -p

# 创建数据库
CREATE DATABASE aiweb_miniprogram CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# 导入数据表结构
USE aiweb_miniprogram;
SOURCE /var/www/aiweb-backend/server/database/schema.sql;

# 退出MySQL
exit;

# 运行初始化脚本
cd /var/www/aiweb-backend
node server/scripts/initDatabase.js
```

**Step 5：使用PM2启动服务**
```bash
# 启动应用
pm2 start server/index.js --name aiweb-api

# 设置开机自启
pm2 startup
pm2 save

# 查看运行状态
pm2 status
pm2 logs aiweb-api

# 常用PM2命令
pm2 restart aiweb-api  # 重启
pm2 stop aiweb-api     # 停止
pm2 delete aiweb-api   # 删除
```

---

#### 🌐 配置Nginx反向代理

**Step 1：创建Nginx配置文件**
```bash
nano /etc/nginx/conf.d/aiweb-api.conf
```

**Step 2：写入配置**
```nginx
# HTTP -> HTTPS 重定向
server {
    listen 80;
    server_name api.yourcompany.com;
    
    # 强制跳转HTTPS
    return 301 https://$server_name$request_uri;
}

# HTTPS配置
server {
    listen 443 ssl http2;
    server_name api.yourcompany.com;
    
    # SSL证书配置
    ssl_certificate /etc/nginx/ssl/api.yourcompany.com.crt;
    ssl_certificate_key /etc/nginx/ssl/api.yourcompany.com.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    # 日志
    access_log /var/log/nginx/aiweb-api-access.log;
    error_log /var/log/nginx/aiweb-api-error.log;
    
    # 客户端请求体大小限制（文件上传）
    client_max_body_size 50M;
    
    # 反向代理到Node.js
    location /api/ {
        proxy_pass http://127.0.0.1:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # 超时设置
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
    
    # 静态文件（上传的图片等）
    location /uploads/ {
        alias /var/www/aiweb-backend/uploads/;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
    
    # Gzip压缩
    gzip on;
    gzip_types text/plain text/css application/json application/javascript;
    gzip_min_length 1000;
}
```

**Step 3：上传SSL证书**
```bash
# 创建SSL目录
mkdir -p /etc/nginx/ssl

# 上传证书文件（使用SFTP或直接复制内容）
nano /etc/nginx/ssl/api.yourcompany.com.crt  # 粘贴证书内容
nano /etc/nginx/ssl/api.yourcompany.com.key  # 粘贴私钥内容

# 设置权限
chmod 600 /etc/nginx/ssl/*.key
```

**Step 4：测试并重启Nginx**
```bash
# 测试配置
nginx -t

# 重启Nginx
systemctl restart nginx

# 查看状态
systemctl status nginx
```

**Step 5：配置防火墙**
```bash
# CentOS 7（firewalld）
firewall-cmd --permanent --add-service=http
firewall-cmd --permanent --add-service=https
firewall-cmd --reload

# Ubuntu（ufw）
ufw allow 80/tcp
ufw allow 443/tcp
ufw reload
```

---

### 2.3 数据库配置

#### 🗄️ MySQL优化配置

**连接到云数据库：**
```bash
mysql -h你的MySQL内网IP -uroot -p
```

**创建专用数据库用户：**
```sql
-- 创建用户
CREATE USER 'aiweb'@'%' IDENTIFIED BY '强密码123!@#';

-- 授权
GRANT ALL PRIVILEGES ON aiweb_miniprogram.* TO 'aiweb'@'%';

-- 刷新权限
FLUSH PRIVILEGES;
```

**优化配置（适用于2核4G）：**
```bash
# 编辑MySQL配置（如果是自建MySQL）
nano /etc/my.cnf

# 添加以下优化参数
[mysqld]
# 连接配置
max_connections = 500
max_connect_errors = 1000

# 缓存配置
innodb_buffer_pool_size = 2G
key_buffer_size = 256M
query_cache_size = 128M
query_cache_limit = 2M

# 日志配置
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2

# 字符集
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci

# 重启MySQL
systemctl restart mysqld
```

**数据库表结构：**

```sql
-- 用户表（支持微信登录）
CREATE TABLE users (
  id INT PRIMARY KEY AUTO_INCREMENT,
  openid VARCHAR(64) UNIQUE NOT NULL COMMENT '微信OpenID',
  unionid VARCHAR(64) COMMENT '微信UnionID',
  nickname VARCHAR(100) COMMENT '昵称',
  avatar_url VARCHAR(500) COMMENT '头像URL',
  phone VARCHAR(20) COMMENT '手机号',
  role ENUM('user', 'admin', 'super_admin') DEFAULT 'user',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INDEX idx_openid (openid),
  INDEX idx_unionid (unionid)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 客户表
CREATE TABLE customers (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT COMMENT '创建者ID',
  name VARCHAR(100) NOT NULL COMMENT '客户名称',
  industry VARCHAR(50) COMMENT '行业',
  contact_person VARCHAR(50) COMMENT '联系人',
  phone VARCHAR(20) COMMENT '电话',
  email VARCHAR(100) COMMENT '邮箱',
  address VARCHAR(500) COMMENT '地址',
  status ENUM('prospect', 'potential', 'customer', 'partner') DEFAULT 'prospect',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,
  INDEX idx_user (user_id),
  INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 商机表
CREATE TABLE opportunities (
  id INT PRIMARY KEY AUTO_INCREMENT,
  customer_id INT NOT NULL,
  user_id INT COMMENT '负责人ID',
  title VARCHAR(200) NOT NULL COMMENT '商机标题',
  amount DECIMAL(12,2) COMMENT '金额',
  stage ENUM('lead', 'qualified', 'proposal', 'negotiation', 'won', 'lost') DEFAULT 'lead',
  probability INT DEFAULT 0 COMMENT '成交概率(%)',
  expected_close_date DATE COMMENT '预计成交日期',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,
  INDEX idx_customer (customer_id),
  INDEX idx_stage (stage)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 产品表
CREATE TABLE products (
  id INT PRIMARY KEY AUTO_INCREMENT,
  category_id INT COMMENT '分类ID',
  name VARCHAR(200) NOT NULL COMMENT '产品名称',
  sku VARCHAR(50) UNIQUE COMMENT 'SKU编码',
  description TEXT COMMENT '描述',
  price DECIMAL(10,2) COMMENT '价格',
  images JSON COMMENT '图片URL数组',
  specs JSON COMMENT '规格参数',
  status ENUM('active', 'inactive') DEFAULT 'active',
  sort_order INT DEFAULT 0 COMMENT '排序',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INDEX idx_category (category_id),
  INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 工作流表
CREATE TABLE workflows (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT COMMENT '创建者ID',
  name VARCHAR(100) NOT NULL COMMENT '工作流名称',
  description TEXT COMMENT '描述',
  flow_data JSON COMMENT '流程定义(节点/连线)',
  status ENUM('draft', 'active', 'paused') DEFAULT 'draft',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,
  INDEX idx_user (user_id),
  INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 执行记录表
CREATE TABLE workflow_executions (
  id INT PRIMARY KEY AUTO_INCREMENT,
  workflow_id INT NOT NULL,
  trigger_user_id INT,
  status ENUM('running', 'completed', 'failed') DEFAULT 'running',
  input_data JSON COMMENT '输入数据',
  output_data JSON COMMENT '输出数据',
  error_message TEXT COMMENT '错误信息',
  started_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  completed_at TIMESTAMP NULL,
  FOREIGN KEY (workflow_id) REFERENCES workflows(id) ON DELETE CASCADE,
  FOREIGN KEY (trigger_user_id) REFERENCES users(id) ON DELETE SET NULL,
  INDEX idx_workflow (workflow_id),
  INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 知识库表
CREATE TABLE knowledge_base (
  id INT PRIMARY KEY AUTO_INCREMENT,
  category VARCHAR(50) COMMENT '分类',
  title VARCHAR(200) NOT NULL COMMENT '标题',
  content LONGTEXT COMMENT '内容',
  file_url VARCHAR(500) COMMENT '文件URL',
  file_type VARCHAR(20) COMMENT '文件类型',
  tags JSON COMMENT '标签数组',
  view_count INT DEFAULT 0 COMMENT '浏览次数',
  download_count INT DEFAULT 0 COMMENT '下载次数',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  INDEX idx_category (category),
  INDEX idx_view (view_count)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 聊天记录表
CREATE TABLE chat_messages (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT NOT NULL,
  role ENUM('user', 'assistant') NOT NULL,
  content TEXT NOT NULL COMMENT '消息内容',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  INDEX idx_user_time (user_id, created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**定期备份脚本：**
```bash
# 创建备份脚本
nano /root/backup_mysql.sh

#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/var/backups/mysql"
DB_NAME="aiweb_miniprogram"
DB_HOST="你的MySQL内网IP"
DB_USER="root"
DB_PASS="你的密码"

# 创建备份目录
mkdir -p $BACKUP_DIR

# 备份数据库
mysqldump -h$DB_HOST -u$DB_USER -p$DB_PASS $DB_NAME | gzip > $BACKUP_DIR/backup_$DATE.sql.gz

# 删除7天前的备份
find $BACKUP_DIR -name "backup_*.sql.gz" -mtime +7 -delete

# 上传到COS（可选）
# coscli cp $BACKUP_DIR/backup_$DATE.sql.gz cos://your-bucket/backups/

# 设置执行权限
chmod +x /root/backup_mysql.sh

# 添加定时任务（每天凌晨3点备份）
crontab -e
# 添加行：0 3 * * * /root/backup_mysql.sh
```

---

### 2.4 域名备案与SSL证书

#### 🌍 域名配置流程

**Step 1：域名注册**
1. 在腾讯云域名注册（https://dnspod.cloud.tencent.com）
2. 搜索并注册域名（如：yourcompany.com）
3. 价格参考：
   - .com域名：¥55/年
   - .cn域名：¥29/年
   - .top域名：¥8/年

**Step 2：域名实名认证**
1. 域名控制台 → 实名认证
2. 提交企业营业执照
3. 等待审核（通常1-3个工作日）

**Step 3：域名备案（中国大陆必须）**

⚠️ **重要：小程序要求后端API必须备案域名**

1. 登录腾讯云备案系统
2. 准备材料：
   - 营业执照副本
   - 法人身份证
   - 网站负责人身份证
   - 域名证书
   - 《网站备案信息真实性核验单》
3. 填写备案信息：
   - **主办单位：** 公司全称
   - **网站名称：** 明升企业智能体管理系统
   - **网站用途：** 企业内部管理系统
   - **服务器：** 选择已购买的CVM
4. 提交初审（腾讯云1-2个工作日）
5. 幕布照片上传（需要幕布拍照）
6. 管局审核（10-20个工作日）
7. 备案成功，获得备案号（如：粤ICP备12345678号）

**Step 4：DNS解析配置**
```bash
# 在腾讯云DNSPod控制台添加记录

# A记录（API服务器）
主机记录: api
记录类型: A
记录值: 你的服务器公网IP
TTL: 600

# A记录（主域名）
主机记录: @
记录类型: A
记录值: 你的服务器公网IP
TTL: 600

# CNAME记录（www跳转）
主机记录: www
记录类型: CNAME
记录值: yourcompany.com
TTL: 600
```

**Step 5：微信小程序域名配置**
1. 登录微信公众平台
2. 开发 → 开发管理 → 开发设置 → 服务器域名
3. 配置以下域名：
   - **request合法域名：** https://api.yourcompany.com
   - **uploadFile合法域名：** https://api.yourcompany.com
   - **downloadFile合法域名：** https://api.yourcompany.com
   - **udp合法域名：** （留空）
4. 注意事项：
   - ✅ 必须是HTTPS
   - ✅ 必须备案
   - ✅ 端口只能443
   - ✅ 不能是IP地址
   - ✅ 不能带端口号

---

#### 🔒 SSL证书配置

**方案A：免费DV证书（推荐新手）**

1. 腾讯云SSL证书控制台
2. 申请免费证书（TrustAsia DV）
3. 填写域名：api.yourcompany.com
4. 选择DNS验证
5. 添加DNS解析记录（自动验证）
6. 等待签发（通常10分钟）
7. 下载证书（Nginx格式）
8. 上传到服务器（参考2.2节）

**方案B：付费OV证书（企业推荐）**

- 腾讯云GlobalSign OV证书：¥1500/年
- 优势：
  - ✅ 显示企业名称
  - ✅ 更高信任度
  - ✅ 支持通配符
  - ✅ 赔付保障

**方案C：Let's Encrypt免费证书（自动续期）**

```bash
# 安装Certbot
yum install -y certbot python3-certbot-nginx

# 自动配置Nginx并获取证书
certbot --nginx -d api.yourcompany.com

# 自动续期（添加定时任务）
crontab -e
# 添加：0 3 * * * certbot renew --quiet

# 强制更新
certbot renew --force-renewal
```

---

## 第三部分：运营推广策略

### 3.1 小程序注册发布流程

#### 📱 注册小程序账号

**Step 1：注册企业小程序**

1. 访问微信公众平台：https://mp.weixin.qq.com
2. 点击"立即注册" → 选择"小程序"
3. 填写账号信息：
   - 邮箱（未注册过微信生态）
   - 密码
4. 邮箱激活
5. 选择主体类型：**企业**
6. 提交企业信息：
   - 企业名称（与营业执照一致）
   - 营业执照注册号
   - 上传营业执照扫描件
   - 企业对公账户
7. 管理员信息验证：
   - 扫码验证（法人微信）
   - 或对公账户打款验证（1-3个工作日）
8. 注册成功，获得AppID

**费用说明：**
- 企业认证费：¥300/年（必须）
- 微信支付（可选）：¥0（企业主体免费）

---

**Step 2：完善小程序信息**

1. 登录小程序后台
2. 设置 → 基本设置
   - **小程序名称：** 明升企业智能体（唯一，不可重名）
   - **简介：** 企业级智能化办公管理平台，集成AICRM、工作流自动化、智能数据分析等核心功能
   - **图标：** 上传256x256 PNG图标
   - **类别：** 工具 > 企业管理 | 商业服务 > 企业协作
   - **标签：** CRM、工作流、智能办公、企业管理、AI助手
3. 成员管理：
   - 添加开发者（最多40人）
   - 添加体验者（最多60人）
4. 开发设置：
   - 获取AppID、AppSecret
   - 配置服务器域名（见2.4节）

---

**Step 3：提交代码审核**

1. 使用HBuilderX打包小程序
   ```bash
   # uni-app项目根目录
   npm run build:mp-weixin
   ```
2. 打开微信开发者工具
3. 导入项目（选择dist/build/mp-weixin目录）
4. 点击"上传"按钮
   - 版本号：1.0.0
   - 备注：首次发布版本
5. 登录小程序后台
6. 版本管理 → 开发版本 → 提交审核
7. 填写审核信息：
   - **核心功能：** CRM客户管理、工作流自动化、智能数据分析
   - **测试账号：** 提供测试账号密码（如有登录）
   - **演示视频：** 上传1-3分钟操作演示（推荐）
   - **隐私政策：** https://yourcompany.com/privacy.html（必填）
   - **用户协议：** https://yourcompany.com/terms.html（必填）
8. 等待审核（通常1-7个工作日）

---

**Step 4：发布上线**

1. 审核通过后，版本管理页面
2. 点击"发布"按钮
3. 小程序正式上线！
4. 生成小程序码/二维码
5. 开始推广

---

#### ⚠️ 常见审核拒绝原因及解决方案

| 拒绝原因 | 解决方案 |
|----------|----------|
| 缺少隐私政策 | 在首页底部添加《隐私政策》链接 |
| 缺少用户协议 | 添加《用户服务协议》并在注册时勾选 |
| 测试账号无法登录 | 提供真实可用的测试账号 |
| 功能描述不清晰 | 详细描述核心功能，附带截图 |
| 涉及金融/支付 | 补充金融资质或移除支付功能 |
| 内容违规 | 检查图片、文案是否符合规范 |
| 类目不匹配 | 修改类目为实际功能相符的类别 |

---

### 3.2 推广渠道与策略

#### 🎯 六大推广渠道

**1. 企业微信生态推广（核心渠道）**

**策略：**
- 集成企业微信应用
- 员工工作台添加小程序入口
- 客户群聊分享小程序卡片
- 企业微信通讯录推广

**实施步骤：**
```markdown
A. 企业微信后台配置
1. 登录企业微信管理后台
2. 应用管理 → 第三方应用 → 添加应用
3. 关联小程序（填入AppID）
4. 设置可见范围（全体员工/特定部门）

B. 工作台展示
1. 应用管理 → 自建 → 工作台应用
2. 添加"明升企业智能体"入口
3. 设置图标、名称、描述

C. 客户联系功能
1. 客户联系 → 聊天工具栏 → 小程序
2. 员工可在聊天中直接分享小程序
3. 客户点击即可使用
```

**预期效果：**
- 内部员工100%触达
- 客户转化率提升30%
- 日活用户增长50%

---

**2. 公众号引流（内容营销）**

**策略：**
- 公众号文章植入小程序卡片
- 菜单栏设置小程序入口
- 自动回复引导关注小程序

**内容规划：**
```markdown
Week 1：产品发布
- 文章：《重磅！明升企业智能体小程序正式上线》
- 插入小程序卡片（首页）
- 阅读原文跳转小程序

Week 2：功能介绍
- 文章：《3分钟上手AICRM，客户管理从未如此简单》
- 插入功能演示视频
- 文章内嵌小程序卡片（AICRM页面）

Week 3：案例分享
- 文章：《某制造企业如何用工作流自动化节省80%重复劳动》
- 客户案例+数据对比
- 引导试用

Week 4：干货教程
- 文章：《企业数字化转型必备的5个工具》
- 小程序功能详解
- 引导收藏小程序
```

**实施技巧：**
```javascript
// 公众号自动回复配置
关键词：CRM / 客户管理 / 智能办公
回复：
【明升企业智能体】小程序为您提供：
✅ AICRM客户管理
✅ 工作流自动化
✅ 智能数据分析
✅ 产品选型工具
点击下方小程序卡片立即体验👇
[小程序卡片]
```

---

**3. 线下物料推广（展会/会议）**

**物料设计：**

**A. 易拉宝/展架（200x80cm）**
```
╔═══════════════════════════════════╗
║                                   ║
║      [公司LOGO]                   ║
║                                   ║
║    明升企业智能体小程序            ║
║   Enterprise AI Platform          ║
║                                   ║
║  ✅ AICRM客户全生命周期管理        ║
║  ✅ 工作流自动化引擎               ║
║  ✅ 智能数据驾驶舱                 ║
║  ✅ AI对话助手                     ║
║                                   ║
║      [小程序码 15x15cm]            ║
║                                   ║
║     扫码体验，立即开启智能办公      ║
║                                   ║
╚═══════════════════════════════════╝
```

**B. 宣传单页（A4双面）**
- 正面：核心功能介绍+小程序码
- 反面：成功案例+联系方式

**C. 名片**
- 背面印刷小程序码
- 销售人员随身携带

**D. 桌贴/立牌**
- 放置在展台、会议桌
- 引导扫码体验

**推广场景：**
- 行业展会（工业自动化展、CRM软件展）
- 企业内训会议
- 商务洽谈
- 产品发布会

---

**4. 社交裂变推广（口碑传播）**

**策略A：分享有礼活动**

```markdown
活动规则：
1. 分享小程序给3位好友
2. 好友注册并完成1次功能使用
3. 赠送VIP功能体验7天
4. 累计邀请10人，赠送定制报告1份

技术实现：
- 分享携带邀请码
- 后台记录邀请关系
- 自动发放奖励
```

**策略B：企业团队赛**

```markdown
活动：企业数字化转型挑战赛
目标：鼓励企业团队集体使用

规则：
1. 企业注册（5人以上）
2. 完成指定任务（创建客户、工作流等）
3. 排行榜展示（按企业积分）
4. 前10名企业赠送年度VIP

奖励：
🥇 第1名：价值¥10,000服务包
🥈 第2名：价值¥5,000服务包
🥉 第3名：价值¥3,000服务包
4-10名：VIP会员1年
```

**策略C：行业社群推广**

```markdown
目标社群：
- 制造业CIO群
- 企业数字化转型群
- 工业互联网行业群
- SaaS软件交流群

推广方式：
1. 群主合作（软文推广）
2. 干货分享（行业洞察+工具介绍）
3. 免费试用（群友专属福利）
4. KOL背书（行业专家推荐）
```

---

**5. 线上广告投放（精准获客）**

**渠道A：微信朋友圈广告**

```markdown
投放策略：
- 定向：制造业企业主、管理者
- 地域：长三角、珠三角工业区
- 年龄：30-50岁
- 预算：¥5,000/月（测试期）

广告创意：
文案：
还在用Excel管理客户？
试试明升AICRM，3分钟搞定客户360画像
[立即体验] → 跳转小程序

素材：
- 封面图：对比图（传统vs智能）
- 视频：15秒产品演示

落地页：
小程序首页（设置专属活动标签）
```

**渠道B：百度/360搜索广告**

```markdown
关键词：
- CRM系统、客户管理软件
- 工作流自动化、OA系统
- 企业数字化转型工具
- 智能数据分析平台

落地页：
H5页面（介绍+小程序码下载）
```

**渠道C：行业媒体/公众号广告**

```markdown
目标媒体：
- 36氪企服点评
- ToB行业头条
- SaaS软件观察
- 制造业数字化

合作方式：
- 软文植入（¥3,000-¥10,000/篇）
- Banner广告（¥5,000/月）
- KOL测评（送VIP换测评文章）
```

**ROI预估：**
| 渠道 | 月预算 | 预计曝光 | 预计注册 | 获客成本 |
|------|--------|----------|----------|----------|
| 朋友圈广告 | ¥5,000 | 50万 | 500人 | ¥10/人 |
| 搜索广告 | ¥3,000 | 10万 | 150人 | ¥20/人 |
| 行业媒体 | ¥8,000 | 20万 | 300人 | ¥27/人 |

---

**6. 合作伙伴渠道（渠道分销）**

**策略：**

**A. 代理商合作**
```markdown
招募对象：
- 企业服务代理商
- IT系统集成商
- 行业解决方案商

合作模式：
- 按成交金额分成：30%-50%
- 提供专属推广素材
- 提供技术支持和培训

激励政策：
月度签单>10家，奖励¥5,000
季度签单>50家，升级为金牌代理
年度签单>200家，专属区域保护
```

**B. 行业协会合作**
```markdown
目标协会：
- 中国机械工业联合会
- 制造业数字化协会
- CIO联盟

合作方式：
1. 成为协会会员/理事单位
2. 协会活动冠名赞助
3. 协会会员专属优惠
4. 联合举办行业沙龙
```

**C. 互补产品合作**
```markdown
合作对象：
- ERP系统厂商
- 财务软件厂商
- HR系统厂商

合作方式：
1. 产品打通（API对接）
2. 联合推广（交叉销售）
3. 捆绑销售（套餐优惠）
```

---

### 3.3 用户增长方案

#### 📈 AARRR增长模型

**A - Acquisition（获客）**

**目标：** 月新增用户1,000人

**策略：**
1. **SEO优化**
   - 小程序名称包含关键词
   - 描述优化（植入"CRM"、"智能办公"）
   - 定期更新内容（提升权重）

2. **小程序搜索优化**
   - 标题：明升企业智能体-AICRM客户管理工作流自动化
   - 标签：#CRM #客户管理 #工作流 #智能办公
   - 服务类目：企业管理、商业服务

3. **附近的小程序**
   - 开通门店（企业地址）
   - 覆盖周边5公里
   - 适合线下门店/办公楼

4. **微信搜一搜**
   - 发布服务（如"客户管理"、"工作流设计"）
   - 关联搜索词触发

---

**A - Activation（激活）**

**目标：** 注册后3天内完成核心功能使用（激活率>60%）

**新手引导流程：**

```markdown
Day 1（首次登录）：
1. 欢迎弹窗（3秒介绍核心价值）
2. 微信授权登录
3. 选择角色（销售/管理者/技术人员）
4. 新手任务：
   ✅ 创建第一个客户
   ✅ 体验AI聊天助手
   ✅ 查看产品选型工具
   完成奖励：解锁高级功能

Day 2（推送提醒）：
- 模板消息："您有1个任务待完成"
- 引导创建第一个工作流

Day 3（深度使用）：
- 推荐高级功能（商机漏斗、数据分析）
- 邀请好友赠送VIP
```

**关键指标：**
- 注册完成率 >90%
- 新手任务完成率 >60%
- 3日留存率 >50%

---

**R - Retention（留存）**

**目标：** 7日留存率>40%，30日留存率>20%

**留存策略：**

1. **功能Hook（上瘾机制）**
   - 每日签到（连续签到奖励）
   - 数据看板（每日推送业务数据）
   - 待办提醒（工作流、客户跟进）

2. **内容运营**
   - 每周推送1篇行业洞察
   - 小课堂更新（产品知识、案例）
   - 功能更新通知

3. **消息推送策略**
   ```markdown
   场景1：沉默用户（3天未登录）
   推送：您的客户【XX公司】标记为高意向，快去跟进吧
   
   场景2：流失预警（7天未登录）
   推送：【AI生成】为您整理了本月业务报告，点击查看
   
   场景3：重要节点
   推送：【商机提醒】客户【XX】预计本周成交，记得跟进哦
   ```

4. **会员体系**
   | 等级 | 条件 | 权益 |
   |------|------|------|
   | 普通用户 | 注册即得 | 基础功能 |
   | 活跃用户 | 连续登录7天 | 高级图表 |
   | VIP用户 | 付费¥99/月 | 全部功能+数据导出 |
   | 企业用户 | 团队5人以上 | 专属客服+定制报表 |

---

**R - Revenue（变现）**

**目标：** 月收入¥50,000（100个付费用户）

**定价策略：**

**免费版（Free）：**
- ✅ 5个客户额度
- ✅ 基础工作流（3个）
- ✅ 数据看板（只读）
- ✅ AI聊天（每日10次）
- ❌ 数据导出
- ❌ 高级图表
- ❌ API对接

**专业版（Pro）：¥99/月/人**
- ✅ 无限客户
- ✅ 无限工作流
- ✅ 完整数据看板
- ✅ AI聊天无限次
- ✅ 数据导出（Excel/PDF）
- ✅ 高级图表（3D驾驶舱）
- ✅ 优先客服

**企业版（Enterprise）：¥499/月/5人起**
- ✅ Pro版全部功能
- ✅ API开放平台
- ✅ 数据权限管理
- ✅ SSO单点登录
- ✅ 专属客户成功经理
- ✅ 定制化报表
- ✅ 私有化部署（可选）

**增值服务：**
- 实施培训：¥3,000/次
- 定制开发：¥10,000起
- 数据迁移：¥2,000起

**支付方式：**
- 微信支付（小程序内）
- 对公转账（企业版）
- 年付享8折优惠

---

**R - Referral（推荐）**

**目标：** K因子>0.5（每个用户带来0.5个新用户）

**推荐机制：**

**1. 邀请奖励**
```markdown
邀请人奖励：
- 邀请1人注册 → 7天Pro会员
- 邀请3人注册 → 1个月Pro会员
- 邀请10人注册 → 3个月Pro会员
- 邀请好友付费 → 获得30%现金返佣

被邀请人奖励：
- 注册即送7天Pro会员
- 首月付费享8折优惠
```

**2. 企业团购**
```markdown
组团优惠：
- 3人团：每人¥89/月（原价¥99）
- 5人团：每人¥79/月
- 10人团：每人¥69/月
```

**3. 案例激励**
```markdown
提供成功案例的企业：
✅ 免费1年企业版
✅ 案例收录至官网
✅ 行业峰会演讲机会
```

**4. 社交分享**
```markdown
分享触点：
- 生成精美报告（带小程序码）
- 分享商机战绩（朋友圈炫耀）
- 邀请协作（客户、同事加入）
```

---

### 3.4 数据监控与优化

#### 📊 关键指标看板

**核心指标（North Star Metric）：**
- **月活跃用户（MAU）：** 至少登录1次/月的用户数
- **目标值：** 第1个月500，第3个月2,000，第6个月5,000

**增长指标：**

| 指标 | 定义 | 目标值 | 监控周期 |
|------|------|--------|----------|
| 新增用户数 | 当日注册用户 | 30人/天 | 每日 |
| 激活率 | 完成新手任务的用户占比 | >60% | 每周 |
| 次日留存 | 注册后第2天再次登录 | >50% | 每周 |
| 7日留存 | 注册后第7天再次登录 | >40% | 每周 |
| 30日留存 | 注册后第30天再次登录 | >20% | 每月 |
| 付费转化率 | 免费→付费用户占比 | >5% | 每月 |
| ARPU | 每用户平均收入 | ¥50 | 每月 |
| NPS净推荐值 | 用户推荐意愿 | >50 | 每季度 |

---

#### 🔍 埋点方案

**使用腾讯移动分析（MTA）：**

1. 注册MTA：https://mta.qq.com
2. 创建小程序应用
3. 接入SDK：
   ```javascript
   // app.js
   import MTA from 'mta-wechat-analysis'
   
   App({
     onLaunch() {
       // 初始化MTA
       MTA.App.init({
         appID: '你的MTA_AppID',
         statPull: true,
         statShare: true
       })
     }
   })
   ```

**关键埋点：**

```javascript
// 页面访问
MTA.Page.init()

// 按钮点击
MTA.Event.stat('click_create_customer', {
  source: 'home_page',
  customer_type: 'enterprise'
})

// 功能使用
MTA.Event.stat('use_aicrm', {
  feature: 'customer_360',
  duration: 120  // 使用时长(秒)
})

// 转化漏斗
MTA.Event.stat('conversion_funnel', {
  step: 'payment_success',
  amount: 99,
  plan: 'pro'
})

// 自定义事件
MTA.Event.stat('share_report', {
  report_type: 'sales_funnel',
  share_to: 'wechat_moment'
})
```

---

#### 📈 数据分析看板

**使用腾讯云日志服务CLS：**

```javascript
// 实时日志采集
const logger = require('winston')
const { TencentCloudLogger } = require('tencent-cloud-logger')

const cloudLogger = new TencentCloudLogger({
  secretId: 'YOUR_SECRET_ID',
  secretKey: 'YOUR_SECRET_KEY',
  region: 'ap-guangzhou',
  topicId: 'YOUR_TOPIC_ID'
})

// 记录用户行为
cloudLogger.info('user_action', {
  user_id: '123',
  action: 'create_workflow',
  timestamp: Date.now(),
  metadata: {
    workflow_name: '客户跟进流程',
    node_count: 5
  }
})

// 记录业务指标
cloudLogger.info('business_metric', {
  metric: 'daily_active_users',
  value: 350,
  date: '2025-12-23'
})
```

**Grafana可视化大屏：**

```yaml
# 安装Grafana
docker run -d -p 3000:3000 --name=grafana grafana/grafana

# 配置数据源（连接MySQL/CLS）
# 创建Dashboard：
面板1：今日新增用户
面板2：用户留存曲线
面板3：付费转化漏斗
面板4：功能使用热力图
面板5：实时在线用户
```

---

#### 🎯 A/B测试优化

**测试场景1：首页Banner文案**

```markdown
版本A（控制组）：
"企业级智能办公平台"

版本B（实验组）：
"3分钟搞定客户管理，销售业绩提升30%"

测试指标：
- 点击率（CTR）
- 注册转化率

测试周期：7天
样本量：各1000人

结果：
版本B点击率提升45%，注册率提升28%
决策：采用版本B
```

**测试场景2：付费弹窗时机**

```markdown
版本A：注册后第3天弹窗
版本B：完成新手任务后立即弹窗
版本C：首次使用高级功能时弹窗

测试指标：
- 付费转化率
- 用户反感度（NPS）

结果：
版本C转化率最高（8.2%），且用户满意度最好
决策：采用版本C
```

**测试工具：**
- 微信小程序A/B测试插件
- 腾讯云A/B测试平台
- 自建分流系统

---

## 🎯 总结与时间表

### 完整开发时间表

| 阶段 | 时间 | 主要工作 | 交付物 |
|------|------|----------|--------|
| **准备期** | Week 0 | 账号注册、环境搭建、服务器购买 | 开发环境就绪 |
| **开发期** | Week 1-6 | 前端迁移、后端适配、功能开发 | 小程序完整代码 |
| **测试期** | Week 7 | 全面测试、Bug修复、性能优化 | 测试报告 |
| **审核期** | Week 8 | 提交审核、准备资料、等待审核 | 审核通过 |
| **推广期** | Week 9+ | 正式发布、推广运营、数据优化 | 用户增长 |

### 预算估算

| 类别 | 项目 | 金额 | 备注 |
|------|------|------|------|
| **开发成本** | 人力成本（2人6周） | ¥60,000 | 1名前端+1名后端 |
| **服务器** | 腾讯云服务器（1年） | ¥5,000 | 标准版配置 |
| **域名证书** | 域名+SSL证书 | ¥500 | 免费证书 |
| **小程序认证** | 企业认证费 | ¥300 | 微信官方 |
| **推广费用** | 初期广告投放 | ¥20,000 | 3个月预算 |
| **设计物料** | UI设计+宣传物料 | ¥5,000 | 外包设计 |
| **培训成本** | 内部培训+文档 | ¥3,000 | 知识沉淀 |
| **应急储备** | 20%预留 | ¥18,000 | 应对变更 |
| **总计** | - | **¥111,800** | - |

### 预期收益（6个月）

| 指标 | 数值 | 说明 |
|------|------|------|
| 注册用户 | 5,000+ | 有效企业用户 |
| 付费用户 | 250+ | 转化率5% |
| 月经常性收入（MRR） | ¥25,000 | 平均¥100/用户 |
| 年度经常性收入（ARR） | ¥300,000 | 首年预期 |
| ROI | 268% | (300,000-111,800)/111,800 |

---

## 📞 后续支持

**如需进一步协助，请联系：**

- 技术支持：tech@yourcompany.com
- 商务合作：bd@yourcompany.com
- 官方网站：https://www.yourcompany.com
- 微信客服：扫描下方二维码

---

**文档版本：** v1.0  
**最后更新：** 2025-12-23  
**作者：** 明升企业智能体开发团队  
**版权所有 © 2025 YourCompany. All Rights Reserved.**
