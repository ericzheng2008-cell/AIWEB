# 🧪 快速测试智能曲线分析功能

**测试时间**: 2025-12-16  
**功能版本**: v3.0.0 - 智能异常检测增强版

---

## 🎯 测试目标

验证基于知识库专业知识的**拧紧曲线智能分析**功能是否正常工作,包括:

1. ✅ 7种异常类型智能检测
2. ✅ 标准曲线对比分析
3. ✅ 关键点自动标注(贴合点/屈服点)
4. ✅ 材质识别与工艺推荐
5. ✅ 专业报告生成

---

## 🚀 快速启动

### 方法1: 命令行启动

```bash
# 进入项目目录
cd c:/Users/EricZ/CodeBuddy/AIWEB1

# 启动开发服务器
npm run dev
```

### 方法2: 双击批处理文件

```bash
双击: 启动开发服务器-请运行我.bat
```

---

## 📋 测试步骤

### 步骤1: 访问曲线分析页面

```
浏览器访问:
http://localhost:5173/curve-analysis

或从主页导航:
顶部菜单 → 拧紧数据 → 曲线对比与分析
```

---

### 步骤2: 查看演示数据

系统已自动加载**5条演示曲线**:

| 曲线编号 | 状态 | 特征说明 |
|---------|------|---------|
| 📊 标准曲线 | 参考 | 黄色粗线,峰值28.5Nm |
| 001 正常 | ✅ 正常 | 绿色✓标记,符合标准 |
| 002 滑牙 | ⚠️ 异常 | 红色标记,扭矩22.5Nm |
| 003 粘滑 | ⚠️ 异常 | 曲线锯齿状 |
| 004 缓升 | ⚠️ 异常 | 斜率0.065 |
| 005 压溃 | ⚠️ 异常 | 双峰现象 |

---

### 步骤3: 测试智能检测功能

#### 3.1 查看图表标注

✅ **检查点**:
- [ ] 标准曲线是否为黄色粗线?
- [ ] 是否有**贴合点**标注(绿色标记)?
- [ ] 是否有**屈服点**标注(橙色标记)?
- [ ] 异常曲线是否有**⚠️红色警告标记**?

#### 3.2 查看三阶段区域

✅ **检查点**:
- [ ] 是否有3个阶段背景色?
  - 0-90°: 浅黄色 (低速认牙)
  - 90-360°: 浅蓝色 (快速旋入)
  - 360-540°: 浅绿色 (拧紧阶段)

#### 3.3 测试Tooltip交互

✅ **检查点**:
- [ ] 鼠标悬停时显示当前阶段?
- [ ] 显示预计时间?
- [ ] 阶段有颜色标注?

---

### 步骤4: 测试智能分析结果

#### 4.1 综合评估标签

点击"**综合评估**"标签页:

✅ **检查点**:
- [ ] 总曲线数 = 5?
- [ ] 合格曲线 = 1?
- [ ] 异常曲线 = 4?
- [ ] 合格率 = 20%?

#### 4.2 问题诊断标签

点击"**问题诊断**"标签页:

✅ **检查点**:
- [ ] 显示**4种异常类型**?
  - 内螺纹滑牙
  - 粘滑现象
  - 扭矩上升缓慢
  - 被连接件压溃

- [ ] 每个异常包含:
  - [ ] 类型 + 严重级别标签
  - [ ] 问题描述
  - [ ] 影响曲线列表
  - [ ] 可能原因(5-6条)
  - [ ] 建议措施(5-6条)

---

### 步骤5: 测试参数对比

点击"**参数对比**"标签页:

✅ **检查点**:
- [ ] 表格显示5条曲线?
- [ ] 包含以下字段:
  - 曲线名称
  - 峰值扭矩
  - 峰值角度
  - 平均斜率
  - 控制策略(扭矩控制/转角控制)
  - 弹性区间
  - 塑性区间
  - 偏差率
  - 质量评级

- [ ] 偏差率有颜色标注:
  - 绿色: <5%
  - 黄色: 5-10%
  - 红色: >10%

---

### 步骤6: 测试材质分析

点击"**材质分析**"标签页:

✅ **检查点**:
- [ ] 显示智能识别材质?
  - 根据平均斜率和扭矩判断
  - 钢质 / 铝合金 / 塑料 / 铸铁 / 复合材料

- [ ] 显示材质特性描述?
- [ ] 显示建议扭矩范围?
- [ ] 显示建议转速?
- [ ] 显示特殊注意事项?

- [ ] 材质对比参考表:
  - [ ] 5种材质特性对比
  - [ ] 典型斜率范围
  - [ ] 扭矩范围
  - [ ] 推荐转速
  - [ ] 主要风险

---

### 步骤7: 测试批次对比

点击"**批次对比**"标签页:

✅ **检查点**:
- [ ] 显示扭矩标准差?
- [ ] 显示角度标准差?
- [ ] 显示工艺稳定性评分(0-100)?
- [ ] 显示一致性评估结论?
  - 工艺稳定 / 基本稳定 / 波动较大
- [ ] 有改进建议(如果不稳定)?

---

### 步骤8: 测试曲线类型切换

点击图表右上角**曲线类型下拉菜单**:

✅ **测试5种曲线类型**:

1. **扭矩-角度** (默认)
   - [ ] X轴: 角度(°)
   - [ ] Y轴: 扭矩(N·m)
   - [ ] 有三阶段标注

2. **扭矩-时间**
   - [ ] X轴: 时间(s)
   - [ ] Y轴: 扭矩(N·m)
   - [ ] 时间自动计算

3. **角度-时间**
   - [ ] X轴: 时间(s)
   - [ ] Y轴: 角度(°)

4. **扭矩转角-时间** (双Y轴)
   - [ ] X轴: 时间(s)
   - [ ] 左Y轴: 扭矩(N·m)
   - [ ] 右Y轴: 角度(°)
   - [ ] 每条曲线有2条线(实线扭矩+虚线角度)

---

### 步骤9: 测试数据导出

点击"**导出数据**"下拉菜单:

#### 9.1 导出CSV

点击"**导出CSV格式**":

✅ **检查点**:
- [ ] 下载文件名: `拧紧曲线数据_2025-12-16.csv`
- [ ] 文件包含字段:
  ```
  曲线名称,点编号,角度,扭矩,时间,状态,工具型号,SN编号,车间,线体,班次
  ```

#### 9.2 导出TXT

点击"**导出TXT格式**":

✅ **检查点**:
- [ ] 下载文件名: `拧紧曲线数据_2025-12-16.txt`
- [ ] 包含每条曲线的完整信息表格

#### 9.3 导出专业报告 ⭐

点击"**导出专业报告 (详细)**":

✅ **检查点**:
- [ ] 下载文件名: `螺栓拧紧曲线专业分析报告_2025-12-16.txt`
- [ ] 包含8个章节:
  1. 基本信息
  2. 曲线概况
  3. 关键阶段标注
  4. 数据表格
  5. 材质分析
  6. 结果判定
  7. 批次一致性
  8. 签名审批

- [ ] 报告格式符合ISO 5393标准
- [ ] 有详细的异常原因和建议

---

### 步骤10: 测试筛选功能

在左侧"**筛选器**"区域:

✅ **测试筛选条件**:
- [ ] 车间筛选(8个选项)
- [ ] 线体筛选
- [ ] 工具型号筛选
- [ ] SN编号筛选
- [ ] 班次筛选(白班/夜班)

✅ **筛选验证**:
- [ ] 选择筛选条件后,曲线列表更新?
- [ ] 图表自动刷新?
- [ ] 分析结果重新计算?

---

### 步骤11: 测试曲线选择

在左侧"**曲线列表**"区域:

✅ **测试功能**:
- [ ] 点击曲线项可选中/取消
- [ ] 选中的曲线有蓝色边框高亮
- [ ] 图表实时更新显示选中曲线
- [ ] 点击👁️查看按钮打开详情对话框
- [ ] 点击🗑️删除按钮移除曲线

---

### 步骤12: 测试图表交互

✅ **测试ECharts功能**:
- [ ] 鼠标滚轮缩放
- [ ] 框选缩放(Shift+拖拽)
- [ ] 点击"重置缩放"按钮恢复
- [ ] 点击"切换网格"显示/隐藏网格
- [ ] 点击"切换图例"显示/隐藏图例
- [ ] 数据区域缩放工具
- [ ] 保存为图片

---

## 🎯 核心功能验证清单

### ✅ 智能异常检测

- [ ] 滑牙检测: angle>200° && torque<10Nm
- [ ] 粘滑检测: 扭矩波动>5次
- [ ] 缓升检测: 弹性斜率<0.08
- [ ] 压溃检测: 扭矩平台检测
- [ ] 断裂检测: 扭矩突降>30Nm
- [ ] 浮钉检测: 贴合点>400°
- [ ] 开裂检测: 多次小跌落

### ✅ 关键点标注

- [ ] 贴合点自动识别
- [ ] 屈服点自动识别
- [ ] 峰值扭矩点标注
- [ ] 三阶段区域划分

### ✅ 标准对比

- [ ] 标准曲线显示(黄色粗线)
- [ ] 偏差计算(扭矩/角度)
- [ ] 对比线叠加
- [ ] 异常高亮显示

### ✅ 材质识别

- [ ] 基于斜率和扭矩判断
- [ ] 5种材质类型识别
- [ ] 工艺参数推荐
- [ ] 特殊注意事项

### ✅ 专业报告

- [ ] 8章节完整报告
- [ ] 符合ISO标准
- [ ] 签名审批区域
- [ ] PDF导出(如需要)

---

## 🐛 常见问题排查

### 问题1: 曲线不显示

**检查**:
- [ ] 浏览器控制台有错误?
- [ ] 数据是否正确加载(F12 → Network)
- [ ] 图表容器尺寸是否为0?

**解决**: 刷新页面(F5)或清除缓存(Ctrl+F5)

### 问题2: 异常检测不准确

**检查**:
- [ ] 数据点数是否<100?
- [ ] 数据格式是否正确 `[[angle, torque], ...]`?

**调整**: 修改`ANOMALY_THRESHOLDS`阈值

### 问题3: 导出报告为空

**检查**:
- [ ] 是否有曲线数据?
- [ ] 是否已执行分析?

**解决**: 先导入曲线并查看分析结果

---

## 📊 预期结果示例

### 智能分析输出

```
✅ 总曲线数: 5条
✅ 合格曲线: 1条 (采集曲线_001)
⚠️ 异常曲线: 4条
   - 滑牙: 1条
   - 粘滑: 1条
   - 缓升: 1条
   - 压溃: 1条

📊 合格率: 20.0%
📈 工艺稳定性评分: 65/100 (基本稳定)

🔍 材质识别: 铝合金连接件
   建议扭矩: 10-18 N·m
   建议转速: 30-50 rpm
```

---

## ✅ 测试完成确认

完成以上12个步骤后,确认以下功能正常:

- [ ] 7种异常类型智能检测
- [ ] 关键点自动标注(贴合点/屈服点)
- [ ] 三阶段区域可视化
- [ ] 标准曲线对比分析
- [ ] 材质识别与工艺推荐
- [ ] 批次一致性分析
- [ ] 5种曲线类型切换
- [ ] 3种导出格式(CSV/TXT/专业报告)
- [ ] 筛选功能
- [ ] 图表交互功能

**测试通过!** 🎉

---

## 📝 测试报告模板

```
测试日期: 2025-12-16
测试人员: [姓名]
功能版本: v3.0.0

测试结果:
✅ 通过项: [数量]/32
⚠️ 部分通过: [数量]/32  
❌ 失败项: [数量]/32

主要问题:
1. [问题描述]
2. [问题描述]

建议改进:
1. [建议内容]
2. [建议内容]

综合评价: [优秀/良好/需改进]
```

---

## 🎓 参考资料

- [拧紧曲线三阶段理论](知识库/拧紧曲线三阶段理论.md)
- [7种异常诊断手册](知识库/拧紧曲线7种常见异常类型诊断手册.md)
- [材质识别系统](知识库/材质智能识别与工艺参数推荐系统.md)

---

**测试成功后,即可投入生产使用!** 🚀
