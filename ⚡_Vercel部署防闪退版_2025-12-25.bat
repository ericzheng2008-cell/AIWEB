@echo off
chcp 65001 >nul
title AIWEB - Verceléƒ¨ç½²ï¼ˆé˜²é—ªé€€ç‰ˆï¼‰
color 0B

:: é˜²æ­¢è‡ªåŠ¨å…³é—­çª—å£
if not "%1"=="am_admin" (
    powershell -Command "Start-Process -FilePath '%0' -ArgumentList 'am_admin' -Verb RunAs"
    exit /b
)

echo.
echo    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo    â•‘   ðŸš€ AIWEB - Verceléƒ¨ç½²å·¥å…·ï¼ˆé˜²é—ªé€€ç‰ˆï¼‰        â•‘
echo    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo    ðŸ“ è¯´æ˜Žï¼š
echo       â€¢ æœ¬å·¥å…·ä¼šä¿æŒçª—å£æ‰“å¼€
echo       â€¢ è¯¦ç»†æ˜¾ç¤ºæ¯ä¸€æ­¥è¿›åº¦
echo       â€¢ å‡ºé”™æ—¶ä¸ä¼šè‡ªåŠ¨å…³é—­
echo.

cd /d "%~dp0"

:: æ­¥éª¤1ï¼šçŽ¯å¢ƒæ£€æŸ¥
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   æ­¥éª¤ [1/7] - çŽ¯å¢ƒæ£€æŸ¥
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo æ£€æŸ¥ Node.js...
node --version >nul 2>&1
if errorlevel 1 (
    color 0C
    echo âŒ Node.jsæœªå®‰è£…
    echo.
    echo è¯·è®¿é—® https://nodejs.org ä¸‹è½½å®‰è£…
    echo å®‰è£…å®ŒæˆåŽé‡æ–°è¿è¡Œæ­¤è„šæœ¬
    echo.
    pause
    exit /b 1
)
for /f "tokens=*" %%v in ('node --version') do set NODE_VERSION=%%v
echo âœ… Node.jsç‰ˆæœ¬: %NODE_VERSION%

echo.
echo æ£€æŸ¥ Vercel CLI...
vercel --version >nul 2>&1
if errorlevel 1 (
    echo âš ï¸  Vercel CLIæœªå®‰è£…
    echo.
    echo æ­£åœ¨å®‰è£… Vercel CLI...
    echo è¯·ç¨å€™ï¼Œè¿™å¯èƒ½éœ€è¦1-2åˆ†é’Ÿ...
    echo.
    call npm install -g vercel
    if errorlevel 1 (
        color 0C
        echo.
        echo âŒ Vercel CLIå®‰è£…å¤±è´¥
        echo.
        echo è¯·æ‰‹åŠ¨å®‰è£…ï¼š
        echo   npm install -g vercel
        echo.
        pause
        exit /b 1
    )
    echo.
    echo âœ… Vercel CLIå®‰è£…æˆåŠŸ
) else (
    for /f "tokens=*" %%v in ('vercel --version') do set VERCEL_VERSION=%%v
    echo âœ… Vercel CLIç‰ˆæœ¬: %VERCEL_VERSION%
)

:: æ­¥éª¤2ï¼šæ¸…ç†æ—§æ–‡ä»¶
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   æ­¥éª¤ [2/7] - æ¸…ç†æ—§æž„å»º
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

if exist dist (
    echo åˆ é™¤ dist ç›®å½•...
    rmdir /s /q dist
    echo âœ… dist å·²åˆ é™¤
)

if exist node_modules\.vite (
    echo åˆ é™¤ .vite ç¼“å­˜...
    rmdir /s /q node_modules\.vite
    echo âœ… .vite ç¼“å­˜å·²æ¸…é™¤
)

if not exist dist (
    if not exist node_modules\.vite (
        echo âœ… æ¸…ç†å®Œæˆ
    )
)

:: æ­¥éª¤3ï¼šæ£€æŸ¥ä¾èµ–
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   æ­¥éª¤ [3/7] - æ£€æŸ¥é¡¹ç›®ä¾èµ–
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

if not exist node_modules (
    echo âš ï¸  ä¾èµ–æœªå®‰è£…
    echo.
    echo æ­£åœ¨å®‰è£…ä¾èµ–...
    echo è¿™å¯èƒ½éœ€è¦3-5åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…...
    echo.
    call npm install
    if errorlevel 1 (
        color 0C
        echo.
        echo âŒ ä¾èµ–å®‰è£…å¤±è´¥
        echo.
        echo è¯·æ£€æŸ¥ï¼š
        echo   1. ç½‘ç»œè¿žæŽ¥æ˜¯å¦æ­£å¸¸
        echo   2. npm æ˜¯å¦é…ç½®æ­£ç¡®
        echo   3. package.json æ˜¯å¦å®Œæ•´
        echo.
        pause
        exit /b 1
    )
    echo.
    echo âœ… ä¾èµ–å®‰è£…å®Œæˆ
) else (
    echo âœ… ä¾èµ–å·²å®‰è£…
)

:: æ­¥éª¤4ï¼šæ£€æŸ¥é…ç½®æ–‡ä»¶
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   æ­¥éª¤ [4/7] - æ£€æŸ¥é…ç½®æ–‡ä»¶
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

if not exist package.json (
    color 0C
    echo âŒ package.json ä¸å­˜åœ¨
    pause
    exit /b 1
)
echo âœ… package.json å­˜åœ¨

if not exist vercel.json (
    echo âš ï¸  vercel.json ä¸å­˜åœ¨ï¼Œæ­£åœ¨åˆ›å»º...
    (
        echo {
        echo   "buildCommand": "npm run build",
        echo   "outputDirectory": "dist",
        echo   "framework": "vue",
        echo   "rewrites": [
        echo     {
        echo       "source": "/(.*)",
        echo       "destination": "/index.html"
        echo     }
        echo   ]
        echo }
    ) > vercel.json
    echo âœ… vercel.json å·²åˆ›å»º
) else (
    echo âœ… vercel.json å­˜åœ¨
)

if not exist vite.config.js (
    color 0C
    echo âŒ vite.config.js ä¸å­˜åœ¨
    pause
    exit /b 1
)
echo âœ… vite.config.js å­˜åœ¨

:: æ­¥éª¤5ï¼šæœ¬åœ°æž„å»ºæµ‹è¯•
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   æ­¥éª¤ [5/7] - æœ¬åœ°æž„å»ºæµ‹è¯•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo â³ æ­£åœ¨æž„å»ºé¡¹ç›®...
echo ðŸ“ è¿™å¯èƒ½éœ€è¦1-3åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…
echo ðŸ’¡ å¦‚æžœå‡ºçŽ°é”™è¯¯ï¼Œè¯·ä»”ç»†æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
echo.

:: å¢žåŠ å†…å­˜é™åˆ¶ï¼Œé˜²æ­¢å†…å­˜æº¢å‡º
set NODE_OPTIONS=--max_old_space_size=4096

call npm run build

if errorlevel 1 (
    color 0C
    echo.
    echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    echo â•‘          âŒ æž„å»ºå¤±è´¥                            â•‘
    echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo.
    echo ðŸ” è¯·æ£€æŸ¥ä¸Šæ–¹çš„é”™è¯¯ä¿¡æ¯
    echo.
    echo ðŸ’¡ å¸¸è§é—®é¢˜ï¼š
    echo   1. è¯­æ³•é”™è¯¯ - æ£€æŸ¥ .vue æ–‡ä»¶
    echo   2. å¯¼å…¥é”™è¯¯ - æ£€æŸ¥ import è¯­å¥
    echo   3. ä¾èµ–ç¼ºå¤± - è¿è¡Œ npm install
    echo   4. å†…å­˜ä¸è¶³ - å¢žåŠ  NODE_OPTIONS
    echo.
    echo ðŸ“– æŸ¥çœ‹å®Œæ•´æŒ‡å—ï¼š
    echo    ðŸ“–_Verceléƒ¨ç½²å®Œæ•´æŒ‡å—_2025-12-25.md
    echo.
    echo ðŸ”§ è¿è¡Œè¯Šæ–­å·¥å…·ï¼š
    echo    ðŸ”§_Verceléƒ¨ç½²è¯Šæ–­_2025-12-25.bat
    echo.
    pause
    exit /b 1
)

echo.
echo âœ… æž„å»ºæˆåŠŸï¼
echo ðŸ“¦ è¾“å‡ºç›®å½•: dist

:: æ­¥éª¤6ï¼šç™»å½•Vercel
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   æ­¥éª¤ [6/7] - Vercelè´¦æˆ·ç™»å½•
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ðŸ’¡ æç¤ºï¼š
echo   â€¢ æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€
echo   â€¢ è¯·åœ¨æµè§ˆå™¨ä¸­å®Œæˆç™»å½•
echo   â€¢ ç™»å½•æˆåŠŸåŽè¿”å›žæ­¤çª—å£
echo.
echo æŒ‰ä»»æ„é”®ç»§ç»­...
pause >nul

echo.
echo æ­£åœ¨æ‰“å¼€æµè§ˆå™¨...
vercel login

if errorlevel 1 (
    color 0C
    echo.
    echo âŒ ç™»å½•å¤±è´¥
    echo.
    echo è¯·æ£€æŸ¥ï¼š
    echo   1. æµè§ˆå™¨æ˜¯å¦æ‰“å¼€
    echo   2. æ˜¯å¦å®ŒæˆæŽˆæƒ
    echo   3. ç½‘ç»œè¿žæŽ¥æ˜¯å¦æ­£å¸¸
    echo.
    pause
    exit /b 1
)

echo.
echo âœ… ç™»å½•æˆåŠŸ

:: æ­¥éª¤7ï¼šéƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒ
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   æ­¥éª¤ [7/7] - éƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒ
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ðŸš€ æ­£åœ¨éƒ¨ç½²åˆ° Vercel...
echo â³ è¿™å¯èƒ½éœ€è¦2-5åˆ†é’Ÿ
echo ðŸ’¡ è¯·ä¿æŒç½‘ç»œè¿žæŽ¥ç¨³å®š
echo.

vercel --prod

if errorlevel 1 (
    color 0C
    echo.
    echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    echo â•‘          âŒ éƒ¨ç½²å¤±è´¥                            â•‘
    echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo.
    echo ðŸ’¡ å¯èƒ½çš„åŽŸå› ï¼š
    echo   1. ç½‘ç»œè¿žæŽ¥ä¸­æ–­
    echo   2. VercelæœåŠ¡å™¨ç¹å¿™
    echo   3. è´¦æˆ·æƒé™é—®é¢˜
    echo   4. é¡¹ç›®é…ç½®é”™è¯¯
    echo.
    echo ðŸ”„ è§£å†³æ–¹æ¡ˆï¼š
    echo   1. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
    echo   2. ç¨åŽé‡è¯•
    echo   3. æŸ¥çœ‹ Vercel Dashboard
    echo   4. è”ç³»æŠ€æœ¯æ”¯æŒ
    echo.
    pause
    exit /b 1
)

:: éƒ¨ç½²æˆåŠŸ
color 0A
echo.
echo.
echo    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo    â•‘        âœ… éƒ¨ç½²æˆåŠŸï¼                            â•‘
echo    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ðŸŽ‰ æ­å–œï¼AIWEBç½‘ç«™å·²æˆåŠŸéƒ¨ç½²åˆ°Vercel
echo.
echo ðŸ“‹ éƒ¨ç½²ä¿¡æ¯ï¼š
echo    â€¢ ç”Ÿäº§åœ°å€æ˜¾ç¤ºåœ¨ä¸Šæ–¹
echo    â€¢ å¯ç«‹å³å…¬ç½‘è®¿é—®
echo    â€¢ æ”¯æŒå…¨çƒCDNåŠ é€Ÿ
echo.
echo ðŸ“– åŽç»­æ“ä½œï¼š
echo    1ï¸âƒ£  è®¿é—®éƒ¨ç½²URLï¼Œæµ‹è¯•æ‰€æœ‰åŠŸèƒ½
echo    2ï¸âƒ£  åœ¨Vercel Dashboardç»‘å®šè‡ªå®šä¹‰åŸŸå
echo    3ï¸âƒ£  é…ç½®çŽ¯å¢ƒå˜é‡ï¼ˆå¦‚éœ€è¦ï¼‰
echo    4ï¸âƒ£  è®¾ç½®GitHubè‡ªåŠ¨éƒ¨ç½²
echo.
echo ðŸ’¡ æç¤ºï¼š
echo    â€¢ æ¯æ¬¡æŽ¨é€åˆ°GitHubä¼šè‡ªåŠ¨éƒ¨ç½²
echo    â€¢ Vercel Dashboard: https://vercel.com/dashboard
echo    â€¢ æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—äº†è§£è¯¦ç»†ä¿¡æ¯
echo.
echo ðŸŒ è®¿é—®åœ°å€ï¼š
echo    ä¸Šæ–¹æ˜¾ç¤ºçš„ Production URL
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

:: è¯¢é—®æ˜¯å¦åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
echo æ˜¯å¦åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€éƒ¨ç½²åœ°å€ï¼Ÿ
echo.
echo   Y - æ˜¯ï¼Œç«‹å³æ‰“å¼€
echo   N - å¦ï¼Œç¨åŽæ‰‹åŠ¨è®¿é—®
echo.
choice /C YN /N /M "è¯·é€‰æ‹© (Y/N): "

if errorlevel 2 (
    echo.
    echo âœ… å·²å–æ¶ˆ
    echo ðŸ“ æ‚¨å¯ä»¥éšæ—¶è®¿é—® Vercel Dashboard æŸ¥çœ‹éƒ¨ç½²åœ°å€
) else (
    echo.
    echo æ­£åœ¨æ‰“å¼€æµè§ˆå™¨...
    start https://vercel.com/dashboard
)

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   ðŸŽŠ æ‰€æœ‰æ­¥éª¤å®Œæˆï¼
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo æŒ‰ä»»æ„é”®å…³é—­çª—å£...
pause >nul
