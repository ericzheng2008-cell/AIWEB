# 📖 cpolar VIP版本完整使用指南

**版本**: v1.0  
**日期**: 2025-12-21  
**固定域名**: www.eqtcf.cn

---

## 🎯 目录

1. [VIP版本介绍](#vip版本介绍)
2. [固定域名配置](#固定域名配置)
3. [快速启动指南](#快速启动指南)
4. [高级功能](#高级功能)
5. [常见问题](#常见问题)
6. [最佳实践](#最佳实践)

---

## 🌟 VIP版本介绍

### 核心优势

| 功能 | 免费版 | VIP版（您当前） |
|-----|-------|----------------|
| **域名固定性** | ❌ 每次变化 | ✅ **永久固定** |
| **自定义域名** | ❌ 随机分配 | ✅ **自定义子域名** |
| **隧道数量** | 1条 | ✅ **3-10条** |
| **访问速度** | 普通节点 | ✅ **VIP专线** |
| **带宽限制** | 2Mbps | ✅ **10Mbps+** |
| **稳定性** | 一般 | ✅ **企业级** |
| **技术支持** | 社区 | ✅ **优先支持** |
| **HTTPS证书** | ✅ 支持 | ✅ **自动续期** |
| **自定义CNAME** | ❌ | ✅ **支持** |
| **IP白名单** | ❌ | ✅ **支持** |

### 适用场景

✅ **企业长期内测**：固定域名，无需每次通知新地址  
✅ **演示系统**：专业域名展示，提升企业形象  
✅ **开发调试**：多条隧道同时穿透前后端  
✅ **第三方回调**：固定回调地址，避免配置变更  
✅ **移动应用测试**：固定API地址，便于配置  

---

## 🔧 固定域名配置

### 您的域名信息

```
主域名：www.eqtcf.cn
CNAME记录值：1c716cc.cname.vip.cpolar.cn
类型：HTTP/HTTPS
区域：China VIP
```

### 配置方法一：cpolar自动托管（推荐）

如果域名是在cpolar购买或托管的，DNS会自动配置，无需手动操作。

**验证方法**：
```batch
# 检查域名是否已生效
ping www.eqtcf.cn

# 应该返回cpolar的IP地址
```

### 配置方法二：第三方域名服务商

如果域名在阿里云/腾讯云/GoDaddy等服务商：

#### 阿里云域名配置

1. **登录阿里云控制台**
   - 访问：https://dns.console.aliyun.com

2. **找到域名 eqtcf.cn**

3. **添加解析记录**
   ```
   记录类型：CNAME
   主机记录：www
   记录值：1c716cc.cname.vip.cpolar.cn
   TTL：600（10分钟）
   ```

4. **保存设置**

5. **验证生效**（5-10分钟后）
   ```batch
   nslookup www.eqtcf.cn
   
   # 正确输出：
   # www.eqtcf.cn  canonical name = 1c716cc.cname.vip.cpolar.cn
   ```

#### 腾讯云域名配置

1. **登录腾讯云控制台**
   - 访问：https://console.cloud.tencent.com/cns

2. **选择域名 eqtcf.cn**

3. **添加CNAME记录**
   ```
   主机记录：www
   记录类型：CNAME
   记录值：1c716cc.cname.vip.cpolar.cn
   TTL：600
   ```

4. **确认添加**

### 配置方法三：无域名（仅使用cpolar子域名）

如果您没有购买域名，cpolar会提供固定子域名：

```
访问地址：https://xxx.cpolar.cn  # cpolar分配的固定子域名
```

---

## 🚀 快速启动指南

### 第一次配置（完整流程）

#### 步骤1：创建配置文件

**运行自动配置脚本**：
```batch
双击运行：💎_VIP版本固定域名配置_2025-12-21.bat
```

或**手动创建配置文件**：

**文件路径**：`C:\Users\EricZ\.cpolar\cpolar.yml`

```yaml
version: "2"
authtoken: YOUR_AUTHTOKEN_HERE  # 从 https://dashboard.cpolar.com/get-started 获取

tunnels:
  aiweb-frontend:
    proto: http
    addr: 5173
    region: cn_vip
    hostname: www.eqtcf.cn
    inspect: true
    bind_tls: true
  
  aiweb-backend:
    proto: http
    addr: 5000
    region: cn_vip
    subdomain: eqtcf-api  # 后端API子域名
    inspect: true
    bind_tls: true
```

#### 步骤2：获取并设置authtoken

1. **访问cpolar控制台**
   ```
   https://dashboard.cpolar.com/get-started
   ```

2. **复制您的Authtoken**

3. **设置token**
   ```batch
   cpolar authtoken YOUR_COPIED_TOKEN
   ```

#### 步骤3：启动服务

**方式1：一键启动（推荐）**
```batch
双击运行：💎_VIP版本快速启动_2025-12-21.bat
```

**方式2：手动启动**
```batch
# 1. 启动后端服务
cd C:\Users\EricZ\CodeBuddy\AIWEB1\server
start node index.js

# 2. 启动前端服务
cd C:\Users\EricZ\CodeBuddy\AIWEB1
start npm run dev

# 3. 启动cpolar（等待前后端启动后）
timeout /t 15
cpolar start-all
```

#### 步骤4：验证访问

```batch
# 1. 本地测试
浏览器访问：http://localhost:5173

# 2. 固定域名测试
浏览器访问：https://www.eqtcf.cn

# 3. 手机测试
手机浏览器访问：https://www.eqtcf.cn
```

### 日常使用（二次启动）

**最简单方式**：
```batch
双击运行：💎_VIP版本快速启动_2025-12-21.bat
```

**访问地址**：
```
https://www.eqtcf.cn
```

---

## 🎨 高级功能

### 1. 多条隧道同时穿透

VIP版支持同时穿透多个端口：

```yaml
tunnels:
  # 前端
  aiweb-frontend:
    proto: http
    addr: 5173
    hostname: www.eqtcf.cn
  
  # 后端API
  aiweb-backend:
    proto: http
    addr: 5000
    subdomain: api-eqtcf
  
  # 数据库管理
  phpmyadmin:
    proto: http
    addr: 8080
    subdomain: db-eqtcf
  
  # WebSocket服务
  websocket:
    proto: http
    addr: 3000
    subdomain: ws-eqtcf
```

### 2. TCP端口穿透

除了HTTP，还支持TCP端口：

```yaml
tunnels:
  mysql:
    proto: tcp
    addr: 3306
    region: cn_vip
  
  ssh:
    proto: tcp
    addr: 22
    region: cn_vip
```

### 3. IP白名单（企业安全）

限制只有特定IP才能访问：

```yaml
tunnels:
  aiweb-frontend:
    proto: http
    addr: 5173
    hostname: www.eqtcf.cn
    ip_restriction:
      allow_cidrs:
        - 192.168.1.0/24  # 允许公司内网
        - 123.45.67.89/32 # 允许特定IP
```

### 4. 自定义响应头

添加安全响应头：

```yaml
tunnels:
  aiweb-frontend:
    proto: http
    addr: 5173
    hostname: www.eqtcf.cn
    response_headers:
      X-Frame-Options: DENY
      X-Content-Type-Options: nosniff
```

### 5. 流量监控

**Web管理界面**：
```
本地访问：http://localhost:9200

功能：
• 实时流量统计
• 请求日志查看
• 连接数监控
• 响应时间分析
```

**在线控制台**：
```
访问：https://dashboard.cpolar.com/status

功能：
• 所有隧道状态
• 历史流量统计
• 带宽使用分析
• 账单明细
```

---

## ❓ 常见问题

### Q1: 域名配置后无法访问

**现象**：访问 www.eqtcf.cn 显示"无法访问此网站"

**诊断步骤**：
```batch
# 1. 检查DNS是否生效
nslookup www.eqtcf.cn

# 2. 如果返回错误或没有CNAME记录
# 说明DNS未生效，需要等待或检查配置

# 3. 清除本地DNS缓存
ipconfig /flushdns

# 4. 检查本地服务是否运行
netstat -ano | findstr :5173

# 5. 检查cpolar是否运行
tasklist | findstr cpolar
```

**解决方案**：
1. **DNS未生效**：等待10-30分钟
2. **本地服务未启动**：运行 `💎_VIP版本快速启动_2025-12-21.bat`
3. **cpolar未运行**：运行 `cpolar start-all`

### Q2: 访问速度慢

**原因分析**：
- VIP节点未正确选择
- 本地网络问题
- 同时在线人数过多

**优化方案**：
```yaml
# 配置文件中指定最优节点
tunnels:
  aiweb-frontend:
    region: cn_vip  # 确保使用VIP节点
    hostname: www.eqtcf.cn
```

**测试节点速度**：
```batch
# 访问管理界面查看延迟
http://localhost:9200
```

### Q3: 如何配置开机自启动

**方式1：任务计划程序**
```batch
# 1. Win+R 输入 taskschd.msc
# 2. 创建任务
#    名称：AIWEB VIP Tunnel
#    触发器：启动时
#    操作：运行 💎_VIP版本快速启动_2025-12-21.bat
```

**方式2：NSSM服务管理器（推荐）**
```batch
# 1. 下载NSSM: https://nssm.cc/download
# 2. 安装服务
nssm install cpolar-vip "C:\Program Files\cpolar\cpolar.exe" "start-all"

# 3. 配置服务
nssm set cpolar-vip AppDirectory "C:\Program Files\cpolar"
nssm set cpolar-vip Start SERVICE_AUTO_START

# 4. 启动服务
nssm start cpolar-vip
```

### Q4: 如何查看隧道连接日志

**本地查看**：
```batch
# 访问Web UI
http://localhost:9200

# 点击隧道名称 → Logs
# 可以看到所有HTTP请求记录
```

**在线查看**：
```batch
# 访问在线控制台
https://dashboard.cpolar.com/status

# 选择隧道 → Activity
# 查看连接历史和统计
```

### Q5: 固定域名能否更换

**答案**：可以，但需要重新配置

**步骤**：
1. 登录 https://dashboard.cpolar.com/reserved
2. 删除旧的保留域名
3. 创建新的保留域名
4. 更新配置文件 `cpolar.yml`
5. 重启cpolar服务

---

## 💡 最佳实践

### 1. 安全配置

```yaml
# 推荐的安全配置
tunnels:
  aiweb-frontend:
    proto: http
    addr: 5173
    hostname: www.eqtcf.cn
    bind_tls: true  # 强制HTTPS
    inspect: true   # 启用流量检查
    # IP白名单（可选）
    ip_restriction:
      allow_cidrs:
        - 0.0.0.0/0  # 允许所有（内测期间）
    # 响应头安全
    response_headers:
      X-Frame-Options: SAMEORIGIN
      X-Content-Type-Options: nosniff
      Strict-Transport-Security: max-age=31536000
```

### 2. 性能优化

**选择最优节点**：
```yaml
region: cn_vip  # VIP专线节点（必须）
```

**启用HTTP/2**：
```yaml
http_endpoint_scheme: https  # 使用HTTPS协议
bind_tls: true
```

### 3. 监控告警

**设置流量阈值告警**（在线控制台）：
1. 访问 https://dashboard.cpolar.com/settings
2. 配置流量阈值（如100GB/月）
3. 设置邮件/短信告警

### 4. 备份配置

**定期备份配置文件**：
```batch
# 备份脚本
copy C:\Users\EricZ\.cpolar\cpolar.yml C:\Backup\cpolar_backup_%date:~0,4%%date:~5,2%%date:~8,2%.yml
```

### 5. 团队协作

**分享访问信息模板**：
```markdown
# AIWEB VIP内测访问

## 访问地址
https://www.eqtcf.cn

## 特性
• 固定域名，永久有效
• 支持HTTPS安全访问
• 7×24小时稳定运行
• 支持手机/电脑/平板

## 测试账号
账号：test001
密码：Test@123

## 注意事项
• 仅限内部测试
• 请勿外传地址
• 发现问题及时反馈
```

---

## 📊 使用统计

### 查看流量使用

**在线控制台**：
```
https://dashboard.cpolar.com/usage

可查看：
• 每日流量统计
• 每月流量统计
• 带宽使用峰值
• 连接数统计
```

### 导出数据

**导出隧道日志**：
```batch
# 访问Web UI
http://localhost:9200

# 点击隧道 → Export Logs
# 可导出CSV/JSON格式
```

---

## 🎯 快速命令参考

```batch
# 启动所有隧道
cpolar start-all

# 启动指定隧道
cpolar start aiweb-frontend

# 停止所有隧道
taskkill /F /IM cpolar.exe

# 查看隧道状态
cpolar status

# 查看配置
cpolar config check

# 更新authtoken
cpolar authtoken YOUR_NEW_TOKEN

# 查看版本
cpolar version

# 升级到最新版
cpolar update
```

---

## 📞 技术支持

### cpolar官方支持

- **文档中心**: https://www.cpolar.com/docs
- **在线工单**: https://dashboard.cpolar.com/support
- **社区论坛**: https://forum.cpolar.com
- **客服邮箱**: support@cpolar.com
- **VIP专线**:（登录后可见）

### AIWEB技术支持

- **快速诊断**: 运行 `🔍_验证异地访问配置_2025-12-21.html`
- **自动修复**: 运行 `🔧_自动修复并测试_2025-12-21.bat`
- **使用指南**: 查看 `📖_制造企业AI工具平台使用指南_2025-12-21.md`

---

## ✅ 配置完成检查清单

- [ ] authtoken已正确设置
- [ ] DNS解析已生效（nslookup验证）
- [ ] 配置文件cpolar.yml已创建
- [ ] 本地服务正常启动（端口5173）
- [ ] cpolar隧道正常运行
- [ ] 本地访问测试通过（localhost:5173）
- [ ] 固定域名访问测试通过（www.eqtcf.cn）
- [ ] 手机外网访问测试通过
- [ ] 开机自启动已配置（可选）
- [ ] 团队成员访问测试通过

---

**祝您使用愉快！** 🎉

**文档版本**: v1.0  
**创建日期**: 2025-12-21  
**适用版本**: cpolar VIP
