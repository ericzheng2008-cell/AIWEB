<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ” åº”ç­”æœºå™¨äººè¯Šæ–­å·¥å…·</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    .header h1 { font-size: 28px; margin-bottom: 10px; }
    .content { padding: 30px; }
    .diagnostic-box {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 5px solid #667eea;
    }
    .diagnostic-box h3 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 18px;
    }
    .check-item {
      background: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .check-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
    }
    .code-block {
      background: #282c34;
      color: #abb2bf;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      margin: 10px 0;
    }
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin: 5px;
    }
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }
    .btn-success {
      background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%);
      color: white;
    }
    .btn-danger {
      background: linear-gradient(135deg, #ff4d4f 0%, #cf1322 100%);
      color: white;
    }
    .result {
      background: #e7f5ff;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      border-left: 4px solid #1890ff;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ” åº”ç­”æœºå™¨äººè¯Šæ–­å·¥å…·</h1>
      <p>è¯Šæ–­ç‚¹å‡»æ— å“åº”é—®é¢˜ | 2025-12-21</p>
    </div>
    
    <div class="content">
      <!-- é—®é¢˜æè¿° -->
      <div class="diagnostic-box">
        <h3>âŒ å½“å‰é—®é¢˜</h3>
        <p><strong>ç°è±¡</strong>ï¼šç‚¹å‡»å³ä¸‹è§’AIäººå½¢åŠ©æ‰‹å›¾æ ‡åï¼Œå¯¹è¯çª—å£æ²¡æœ‰æ‰“å¼€</p>
        <p style="margin-top: 10px;"><strong>å½±å“</strong>ï¼šç”¨æˆ·æ— æ³•ä½¿ç”¨åº”ç­”æœºå™¨äººåŠŸèƒ½</p>
      </div>
      
      <!-- è¯Šæ–­æ­¥éª¤ -->
      <div class="diagnostic-box">
        <h3>ğŸ”¬ è¯Šæ–­æ­¥éª¤</h3>
        
        <div class="check-item">
          <input type="checkbox" id="check1">
          <label for="check1">
            <strong>æ­¥éª¤1</strong>ï¼šæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰JavaScripté”™è¯¯
          </label>
        </div>
        
        <div class="check-item">
          <input type="checkbox" id="check2">
          <label for="check2">
            <strong>æ­¥éª¤2</strong>ï¼šæ£€æŸ¥AIåŠ©æ‰‹æŒ‰é’®æ˜¯å¦å¯è§ï¼ˆå³ä¸‹è§’ï¼‰
          </label>
        </div>
        
        <div class="check-item">
          <input type="checkbox" id="check3">
          <label for="check3">
            <strong>æ­¥éª¤3</strong>ï¼šç‚¹å‡»AIåŠ©æ‰‹æŒ‰é’®ï¼Œè§‚å¯Ÿæ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯è¾“å‡º
          </label>
        </div>
        
        <div class="check-item">
          <input type="checkbox" id="check4">
          <label for="check4">
            <strong>æ­¥éª¤4</strong>ï¼šæ£€æŸ¥chatStore.chatVisibleçŠ¶æ€
          </label>
        </div>
      </div>
      
      <!-- å¯èƒ½çš„åŸå›  -->
      <div class="diagnostic-box">
        <h3>ğŸ” å¯èƒ½çš„åŸå› </h3>
        
        <p><strong>åŸå› 1ï¼šæ‹–æ‹½é˜»æ­¢äº†ç‚¹å‡»äº‹ä»¶</strong></p>
        <div class="code-block">
@click="!isButtonDragging && toggleChat()"
// å¦‚æœisButtonDraggingä¸ºtrueï¼ŒtoggleChatä¸ä¼šæ‰§è¡Œ
        </div>
        
        <p style="margin-top: 15px;"><strong>åŸå› 2ï¼šchatVisibleçŠ¶æ€æœªæ­£ç¡®åˆ‡æ¢</strong></p>
        <div class="code-block">
toggleChat() {
  this.chatVisible = !this.chatVisible
}
// æ£€æŸ¥çŠ¶æ€æ˜¯å¦æ­£ç¡®æ›´æ–°
        </div>
        
        <p style="margin-top: 15px;"><strong>åŸå› 3ï¼šçª—å£è¢«é®ç½©å±‚é˜»æŒ¡</strong></p>
        <div class="code-block">
v-if="chatStore.chatVisible && !isMinimized"
// ç¡®è®¤æ¡ä»¶æ˜¯å¦æ»¡è¶³
        </div>
      </div>
      
      <!-- ä¿®å¤æ–¹æ¡ˆ -->
      <div class="diagnostic-box">
        <h3>âœ… ä¿®å¤æ–¹æ¡ˆ</h3>
        
        <p><strong>æ–¹æ¡ˆ1ï¼šä¼˜åŒ–æ‹–æ‹½é€»è¾‘</strong></p>
        <div class="code-block">
// ä¿®æ”¹startButtonDragï¼Œåªåœ¨é•¿æŒ‰æ—¶æ‰è¿›å…¥æ‹–æ‹½æ¨¡å¼
let dragTimer = null
const startButtonDrag = (e) => {
  dragTimer = setTimeout(() => {
    isButtonDragging.value = true
    // æ‹–æ‹½é€»è¾‘
  }, 200) // 200msåæ‰è¿›å…¥æ‹–æ‹½æ¨¡å¼
}

const endButtonDrag = () => {
  clearTimeout(dragTimer)
  isButtonDragging.value = false
}
        </div>
        
        <p style="margin-top: 15px;"><strong>æ–¹æ¡ˆ2ï¼šæ·»åŠ è°ƒè¯•æ—¥å¿—</strong></p>
        <div class="code-block">
const toggleChat = () => {
  console.log('toggleChat called, current visible:', chatStore.chatVisible)
  chatStore.toggleChat()
  console.log('after toggle, visible:', chatStore.chatVisible)
  hasUnread.value = false
  isMinimized.value = false
  if (chatStore.chatVisible) {
    nextTick(() => {
      scrollToBottom()
    })
  }
}
        </div>
        
        <p style="margin-top: 15px;"><strong>æ–¹æ¡ˆ3ï¼šç¡®ä¿storeåˆå§‹åŒ–</strong></p>
        <div class="code-block">
// åœ¨aiChat.jsä¸­ç¡®è®¤åˆå§‹å€¼
state: () => ({
  chatVisible: false, // ç¡®ä¿åˆå§‹ä¸ºfalse
  messages: [],
  isTyping: false
})
        </div>
      </div>
      
      <!-- ä¸€é”®ä¿®å¤ -->
      <div class="diagnostic-box">
        <h3>ğŸ”§ ä¸€é”®åº”ç”¨ä¿®å¤</h3>
        <p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åº”ç”¨ä¼˜åŒ–æ–¹æ¡ˆ</p>
        <button class="btn btn-success" onclick="copyFixCode()">ğŸ“‹ å¤åˆ¶ä¿®å¤ä»£ç </button>
        <button class="btn btn-primary" onclick="openDevTools()">ğŸ” æ‰“å¼€å¼€å‘è€…å·¥å…·</button>
        <button class="btn btn-danger" onclick="clearCache()">ğŸ—‘ï¸ æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°</button>
      </div>
      
      <!-- æµ‹è¯•æ­¥éª¤ -->
      <div class="diagnostic-box">
        <h3>ğŸ§ª æµ‹è¯•æ­¥éª¤</h3>
        <ol style="margin-left: 20px; line-height: 1.8;">
          <li>åº”ç”¨ä¿®å¤ä»£ç åï¼Œé‡å¯å¼€å‘æœåŠ¡å™¨</li>
          <li>è®¿é—® http://localhost:3002</li>
          <li>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰</li>
          <li>ç‚¹å‡»å³ä¸‹è§’AIåŠ©æ‰‹å›¾æ ‡</li>
          <li>è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—è¾“å‡º</li>
          <li>ç¡®è®¤å¯¹è¯çª—å£æ˜¯å¦æ‰“å¼€</li>
        </ol>
      </div>
      
      <!-- ç»“æœæ˜¾ç¤º -->
      <div id="resultBox" style="display: none;" class="result">
        <strong>âœ… ä¿®å¤ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</strong>
        <p style="margin-top: 10px;">è¯·åœ¨IDEä¸­åº”ç”¨è¿™äº›ä¿®å¤ï¼Œç„¶åé‡å¯æœåŠ¡å™¨æµ‹è¯•ã€‚</p>
      </div>
    </div>
  </div>
  
  <script>
    function copyFixCode() {
      const code = `// ğŸ”§ ä¿®å¤1ï¼šä¼˜åŒ–æ‹–æ‹½é€»è¾‘ï¼ˆåœ¨AiChat.vueä¸­ï¼‰
let dragTimer = null

const startButtonDrag = (e) => {
  e.stopPropagation()
  
  dragTimer = setTimeout(() => {
    isButtonDragging.value = true
    // åŸæœ‰æ‹–æ‹½é€»è¾‘
  }, 200) // 200msåæ‰è¿›å…¥æ‹–æ‹½æ¨¡å¼
}

const endButtonDrag = () => {
  clearTimeout(dragTimer)
  isButtonDragging.value = false
}

// ğŸ”§ ä¿®å¤2ï¼šæ·»åŠ è°ƒè¯•æ—¥å¿—
const toggleChat = () => {
  console.log('ğŸ” toggleChat called, current visible:', chatStore.chatVisible)
  chatStore.toggleChat()
  console.log('âœ… after toggle, visible:', chatStore.chatVisible)
  hasUnread.value = false
  isMinimized.value = false
  if (chatStore.chatVisible) {
    nextTick(() => {
      scrollToBottom()
    })
  }
}`;
      
      navigator.clipboard.writeText(code).then(() => {
        document.getElementById('resultBox').style.display = 'block';
        setTimeout(() => {
          document.getElementById('resultBox').style.display = 'none';
        }, 5000);
      });
    }
    
    function openDevTools() {
      alert('è¯·æŒ‰ F12 é”®æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼Œç„¶åï¼š\n\n1. åˆ‡æ¢åˆ° Console æ ‡ç­¾\n2. ç‚¹å‡» AI åŠ©æ‰‹å›¾æ ‡\n3. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º\n4. æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯');
    }
    
    function clearCache() {
      if (confirm('ç¡®å®šè¦æ¸…é™¤ç¼“å­˜å¹¶åˆ·æ–°é¡µé¢å—ï¼Ÿ\nè¿™å°†é‡æ–°åŠ è½½æ‰€æœ‰èµ„æºã€‚')) {
        location.reload(true);
      }
    }
  </script>
</body>
</html>
