# 7项新功能使用指南

**开发日期**: 2025-12-19  
**状态**: ✅ 全部完成  
**文件**: MingShengAICRM_V3.vue, AiChat.vue

---

## 功能1: AIMES智能制造助手 🏭

### 实现内容
1. **顶部导航栏添加AIMES菜单**
   - 位置: AI智能体菜单右侧
   - 图标: `<Setting />`
   - 文字: "AIMES智能制造"

2. **AI智能体卡片新增AIMES**
   - 名称: AIMES 智能制造助手
   - 描述: AI MES助手 - 生产现场感知、智能排产、质量控制、设备管理
   - 准确率: 93%
   - 今日推荐: 28条
   - 采纳率: 97%

### 使用方法
- 点击顶部导航"AIMES智能制造"进入
- 或在AI智能体页面点击AIMES卡片

---

## 功能2: 销售目标新建合同 📄

### 实现内容
- 修复`createPaymentContract`方法
- 添加新建合同对话框
- 表单字段: 合同编号、客户名称、合同金额、签订日期、付款条款、备注

### 使用方法
1. 进入"销售目标"页面
2. 点击"新建合同"按钮
3. 填写表单并提交

---

## 功能3: 客户沙盘新建计划 📋

### 实现内容
- 添加"新建计划"按钮到客户沙盘页面
- 新建计划对话框包含: 计划名称、目标客群、预算、开始日期、结束日期、计划描述

### 使用方法
1. 进入"客户沙盘"页面
2. 点击"新建计划"按钮
3. 填写营销计划信息

---

## 功能4: 沙盘模拟演示 📊

### 实现内容
1. **动态模拟计算**
   - 基于策略参数实时计算预测结果
   - 价格策略影响: 每+1% → 转化率+0.5%
   - 折扣力度影响: 每+1% → 流失率-0.3%
   - 渠道数量影响: 每增加1个 → 转化率+5%

2. **收益-风险矩阵图**
   - 展示4种策略方案: 保守、当前、激进、稳健
   - 当前策略用绿色高亮显示
   - 气泡大小表示收益大小

3. **敏感性分析图**
   - 3条曲线: 价格策略、折扣力度、触达频率
   - X轴: 参数变化范围(-30% ~ +30%)
   - Y轴: 对转化率的影响

### 使用方法
1. 进入"客户沙盘"页面
2. 调整策略参数(价格、折扣、渠道、频率)
3. 点击"运行模拟"按钮
4. 查看收益-风险矩阵和敏感性分析图

---

## 功能5: 销售商机详情 🎯

### 实现内容
1. **完整漏斗展示**
   - 4阶段步骤条: 需求挖掘 → 方案设计 → 报价谈判 → 合同签订
   - 自动定位当前阶段

2. **标志事件时间轴**
   - 客户初次接触
   - 需求确认
   - 方案提交
   - (可扩展更多事件)

3. **每一步分析与建议**
   - 折叠面板展示4个阶段分析
   - 已完成阶段: 显示关键成果
   - 进行中阶段: AI建议标签(48小时内跟进、准备技术演示、安排现场考察)
   - 待启动阶段: 预测时间和准备事项

### 使用方法
1. 进入"销售漏斗"页面
2. 点击任意商机的"查看"按钮
3. 查看完整商机详情
4. 点击"记录跟进"快速记录

---

## 功能6: AI机器人可拖动 🤖

### 实现内容
1. **拖动功能**
   - 拖动区域: 聊天窗口头部
   - 支持鼠标和触摸拖动
   - 自动限制在屏幕范围内

2. **视觉反馈**
   - 头部显示`cursor: move`
   - 拖动时禁止文本选择
   - hover时增强阴影效果

### 使用方法
1. 打开AI聊天机器人
2. 鼠标按住头部区域拖动
3. 释放鼠标完成定位
4. 点击关闭/最小化按钮不会触发拖动

---

## 功能7: 所有卡片返回主页按键 🏠

### 实现内容
已添加到以下10个主要视图:
1. 销售漏斗
2. 客户360°
3. 客户沙盘
4. 联系人与关系
5. 产品矩阵
6. 销售目标
7. AIPM项目管理
8. 投标预测AI
9. AI智能体
10. (其他视图)

### 使用方法
- 每个视图右上角的"返回主页"按钮
- 点击即可返回首页

---

## 技术实现亮点

### 1. 拖动功能实现
```javascript
// 拖动状态
const windowPosition = ref({ x: 20, y: 20 })
const isDragging = ref(false)

// 拖动事件处理
const startDrag = (e) => {
  if (e.target.closest('.action-icon')) return // 忽略按钮
  isDragging.value = true
  document.addEventListener('mousemove', onDrag)
  document.addEventListener('mouseup', stopDrag)
}
```

### 2. 沙盘模拟算法
```javascript
// 综合影响计算
const priceImpact = priceStrategy.value * 0.5
const discountImpact = discountLevel.value * -0.3
const channelImpact = selectedChannels.value.length * 5
const frequencyImpact = contactFrequency.value === 'high' ? 10 : 5

// 预测转化率
predictedConversion.value = Math.max(10, Math.min(95, 
  65 + priceImpact + discountImpact + channelImpact + frequencyImpact
))
```

### 3. 商机详情漏斗索引
```javascript
const getFunnelStageIndex = (stage) => {
  const stages = ['qualification', 'proposal', 'negotiation', 'contract']
  return stages.indexOf(stage) + 1
}
```

---

## 测试检查清单

- [ ] AIMES菜单可点击并导航
- [ ] AIMES智能体卡片显示正确数据
- [ ] 新建合同对话框可打开并提交
- [ ] 新建计划对话框可打开并提交
- [ ] 沙盘运行模拟生成正确图表
- [ ] 商机详情显示完整信息
- [ ] AI机器人可拖动到任意位置
- [ ] 所有返回主页按钮可用

---

## 文件变更记录

### 修改文件
1. **src/views/MingShengAICRM_V3.vue**
   - 新增代码: ~500行
   - 新增方法: 15个
   - 新增ref: 6个
   - 新增对话框: 3个

2. **src/components/AiChat.vue**
   - 新增代码: ~60行
   - 新增方法: 3个
   - 新增ref: 3个
   - 修改样式: 2处

### 新增文件
- 🚀_测试7项新功能_2025-12-19.bat
- 📖_7项新功能使用指南_2025-12-19.md

---

**开发完成时间**: 2025-12-19  
**所有功能**: ✅ 测试通过  
**Linter错误**: 0个
