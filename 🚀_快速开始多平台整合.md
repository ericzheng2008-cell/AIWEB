# ğŸš€ å¿«é€Ÿå¼€å§‹ï¼šå¤šå¹³å°æ•´åˆæŒ‡å—

## ğŸ“‹ å‰ç½®å‡†å¤‡

### 1. ç”³è¯·å¹³å°è´¦å·å’ŒAPIæƒé™

#### å¾®ä¿¡ç”Ÿæ€
- [ ] **å¾®ä¿¡å…¬ä¼—å·**
  - ç™»å½• https://mp.weixin.qq.com
  - ç”³è¯·æœåŠ¡å·ï¼ˆéœ€è¦ä¼ä¸šèµ„è´¨ï¼‰
  - å¼€é€šæ¨¡æ¿æ¶ˆæ¯ã€å®¢æœæ¥å£æƒé™
  - è·å– AppID å’Œ AppSecret

- [ ] **ä¼ä¸šå¾®ä¿¡**
  - ç™»å½• https://work.weixin.qq.com
  - åˆ›å»ºä¼ä¸šåº”ç”¨
  - è·å– CorpIDã€Secretã€AgentID

- [ ] **å¾®ä¿¡å°ç¨‹åº**
  - ç™»å½• https://mp.weixin.qq.com
  - æ³¨å†Œå°ç¨‹åºè´¦å·
  - è·å– AppID å’Œ AppSecret

#### ç”µå•†å¹³å°
- [ ] **äº¬ä¸œå¼€æ”¾å¹³å°**
  - ç™»å½• https://open.jd.com
  - ç”³è¯·åº”ç”¨ï¼Œé€‰æ‹©"äº¬ä¸œå’šå’š"æƒé™
  - è·å– AppKey å’Œ AppSecret

- [ ] **æ·˜å®å¼€æ”¾å¹³å°**
  - ç™»å½• https://open.taobao.com
  - ç”³è¯·åº”ç”¨ï¼Œé€‰æ‹©åƒç‰›å·¥ä½œå°æƒé™
  - è·å– AppKey å’Œ AppSecret

- [ ] **é˜¿é‡Œå·´å·´1688**
  - ç™»å½• https://open.1688.com
  - ç”³è¯·ä¼ä¸šè´¦å·å’ŒAPIæƒé™

---

## âš™ï¸ ç¯å¢ƒé…ç½®

### 1. å®‰è£…ä¾èµ–

```bash
cd c:/Users/EricZ/CodeBuddy/AIWEB1

# å®‰è£…å¹³å°é›†æˆä¾èµ–
npm install wechat-api co-wechat-enterprise-api --save
npm install crypto xml2js --save

# å®‰è£…ç”µå•†å¹³å°SDKï¼ˆå¦‚éœ€è¦ï¼‰
# npm install @jd/jd-open-api
# npm install top-sdk (æ·˜å®)
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env.platform` æ–‡ä»¶ï¼š

```bash
# ===== å¾®ä¿¡å…¬ä¼—å· =====
WECHAT_APPID=wx1234567890abcdef
WECHAT_SECRET=your_wechat_secret
WECHAT_TOKEN=your_wechat_token

# ===== ä¼ä¸šå¾®ä¿¡ =====
WORK_WEIXIN_CORPID=ww1234567890abcdef
WORK_WEIXIN_SECRET=your_work_weixin_secret
WORK_WEIXIN_AGENTID=1000001

# ===== äº¬ä¸œ =====
JD_APP_KEY=your_jd_app_key
JD_APP_SECRET=your_jd_app_secret
JD_SHOP_ID=your_shop_id

# ===== æ·˜å® =====
TAOBAO_APP_KEY=your_taobao_app_key
TAOBAO_APP_SECRET=your_taobao_app_secret

# ===== é˜¿é‡Œå·´å·´1688 =====
ALIBABA_APP_KEY=your_alibaba_app_key
ALIBABA_APP_SECRET=your_alibaba_app_secret

# ===== ç³»ç»Ÿé…ç½® =====
API_BASE_URL=http://localhost:3000
WEB_URL=http://localhost:5173
```

### 3. åŠ è½½ç¯å¢ƒå˜é‡

åœ¨ `server/index.js` ä¸­æ·»åŠ ï¼š

```javascript
require('dotenv').config({ path: '.env.platform' });

const platformIntegration = require('./integration/platformIntegration');
app.use('/api/platform', platformIntegration.router);
```

---

## ğŸ”§ å¿«é€Ÿæµ‹è¯•

### 1. æµ‹è¯•å¾®ä¿¡å…¬ä¼—å·

```bash
# å¯åŠ¨æœåŠ¡å™¨
npm run server

# ä½¿ç”¨å†…ç½‘ç©¿é€å·¥å…·ï¼ˆå¦‚ngrokï¼‰æš´éœ²æœ¬åœ°æœåŠ¡
ngrok http 3000

# åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®æœåŠ¡å™¨åœ°å€
# URL: https://your-ngrok-url.ngrok.io/api/platform/wechat/official-account
# Token: ä¸ .env.platform ä¸­çš„ WECHAT_TOKEN ä¸€è‡´

# å‘é€æµ‹è¯•æ¶ˆæ¯
# åœ¨å…¬ä¼—å·å‘é€ï¼šå¥—ç­’é€‰å‹ 12.5mm
```

### 2. æµ‹è¯•ä¼ä¸šå¾®ä¿¡

```bash
# åœ¨ä¼ä¸šå¾®ä¿¡åå°é…ç½®åº”ç”¨å›è°ƒURL
# https://your-ngrok-url.ngrok.io/api/platform/work-weixin/callback

# æµ‹è¯•å‘é€å‘Šè­¦
curl -X POST http://localhost:3000/api/platform/work-weixin/test-alert
```

### 3. æµ‹è¯•äº¬ä¸œå®¢æœ

```bash
# æ¨¡æ‹Ÿå®¢æˆ·æ¶ˆæ¯
curl -X POST http://localhost:3000/api/platform/jd/customer-message \
  -H "Content-Type: application/json" \
  -d '{
    "customerId": "test_user_123",
    "content": "æœ‰12.5mmçš„å¥—ç­’å—ï¼Ÿ",
    "sessionId": "session_123"
  }'
```

---

## ğŸ“± å¾®ä¿¡å°ç¨‹åºå¿«é€Ÿå¼€å‘

### 1. åˆ›å»ºå°ç¨‹åºé¡¹ç›®

```bash
# ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·
# æ–°å»ºé¡¹ç›® â†’ é€‰æ‹©å°ç¨‹åº â†’ è¾“å…¥ AppID
```

### 2. æ ¸å¿ƒé¡µé¢ä»£ç 

**pages/tool-selection/index.wxml**
```xml
<view class="container">
  <view class="title">æ™ºèƒ½å·¥å…·é€‰å‹</view>
  
  <form bindsubmit="handleSubmit">
    <input name="size" placeholder="è¯·è¾“å…¥å°ºå¯¸ï¼ˆmmï¼‰" type="digit" />
    <input name="torque" placeholder="è¯·è¾“å…¥æ‰­çŸ©ï¼ˆNmï¼‰" type="digit" />
    <button formType="submit">å¼€å§‹æ¨è</button>
  </form>
  
  <view class="results" wx:if="{{recommendations.length > 0}}">
    <view class="product-card" wx:for="{{recommendations}}" wx:key="id">
      <image src="{{item.image}}" />
      <text>{{item.name}}</text>
      <text class="price">Â¥{{item.price}}</text>
      <button bindtap="buyNow" data-product="{{item}}">ç«‹å³è´­ä¹°</button>
    </view>
  </view>
</view>
```

**pages/tool-selection/index.js**
```javascript
Page({
  data: {
    recommendations: []
  },

  handleSubmit(e) {
    const { size, torque } = e.detail.value;
    
    wx.showLoading({ title: 'æ™ºèƒ½åˆ†æä¸­...' });
    
    wx.cloud.callFunction({
      name: 'aiAgent',
      data: {
        action: 'toolSelection',
        params: { size, torque }
      }
    }).then(res => {
      this.setData({
        recommendations: res.result.data
      });
      wx.hideLoading();
    }).catch(err => {
      wx.showToast({ title: 'åˆ†æå¤±è´¥', icon: 'none' });
    });
  },

  buyNow(e) {
    const product = e.currentTarget.dataset.product;
    
    // è·³è½¬äº¬ä¸œ/æ·˜å®å°ç¨‹åº
    if (product.jdUrl) {
      wx.navigateToMiniProgram({
        appId: 'wx91d27dbf599dff74', // äº¬ä¸œå°ç¨‹åºAppID
        path: product.jdUrl
      });
    }
  }
});
```

---

## ğŸ›’ ç”µå•†å¹³å°å¯¹æ¥ç¤ºä¾‹

### äº¬ä¸œæ™ºèƒ½å®¢æœéƒ¨ç½²

```javascript
// åœ¨äº¬ä¸œå•†å®¶åå°é…ç½®æ™ºèƒ½å®¢æœ
// 1. è¿›å…¥"å®¢æˆ·æœåŠ¡" â†’ "æ™ºèƒ½å®¢æœè®¾ç½®"
// 2. é…ç½®webhook: https://your-domain.com/api/platform/jd/customer-message
// 3. æµ‹è¯•å¯¹è¯

// æµ‹è¯•è„šæœ¬
const testJDCustomerService = async () => {
  const message = {
    customerId: 'jd_test_user',
    content: 'æ¨èä¸€æ¬¾12.5mmçš„å¥—ç­’',
    sessionId: 'session_' + Date.now()
  };

  const response = await fetch('http://localhost:3000/api/platform/jd/customer-message', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(message)
  });

  const result = await response.json();
  console.log('æ¨èç»“æœ:', result);
};
```

### æ·˜å®åƒç‰›æ’ä»¶å¼€å‘

```javascript
// åƒç‰›å·¥ä½œå°æ’ä»¶å¼€å‘
// å‚è€ƒå®˜æ–¹æ–‡æ¡£: https://open.taobao.com/doc.htm?docId=106448&docType=1

// æ’ä»¶å…¥å£
window.onload = function() {
  // ç›‘å¬èŠå¤©æ¶ˆæ¯
  window.addEventListener('message', async (event) => {
    const { type, data } = event.data;
    
    if (type === 'customer_message') {
      // è°ƒç”¨æ™ºèƒ½æ¨è
      const suggestions = await getSmartSuggestions(data.content);
      
      // æ˜¾ç¤ºåœ¨åƒç‰›ç•Œé¢
      parent.postMessage({
        type: 'show_suggestions',
        data: suggestions
      }, '*');
    }
  });
};

async function getSmartSuggestions(message) {
  const response = await fetch('/api/platform/taobao/qianniu-message', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ content: message })
  });
  
  return await response.json();
}
```

---

## ğŸ“Š æ•°æ®åŒæ­¥é…ç½®

### å®šæ—¶ä»»åŠ¡è®¾ç½®

```javascript
// server/tasks/dataSyncTasks.js
const cron = require('node-cron');

// æ¯å°æ—¶åŒæ­¥ä¸€æ¬¡å•†å“æ•°æ®
cron.schedule('0 * * * *', async () => {
  console.log('å¼€å§‹åŒæ­¥å•†å“æ•°æ®...');
  
  const platforms = ['jd', 'taobao', 'alibaba'];
  
  for (const platform of platforms) {
    try {
      await syncProductData(platform);
      console.log(`${platform} å•†å“æ•°æ®åŒæ­¥å®Œæˆ`);
    } catch (error) {
      console.error(`${platform} åŒæ­¥å¤±è´¥:`, error);
    }
  }
});

// æ¯å¤©å‡Œæ™¨åŒæ­¥ç”¨æˆ·æ•°æ®
cron.schedule('0 0 * * *', async () => {
  console.log('å¼€å§‹åŒæ­¥ç”¨æˆ·æ•°æ®...');
  await syncUserData();
});

// æ¯5åˆ†é’Ÿæ£€æŸ¥è®¢å•çŠ¶æ€
cron.schedule('*/5 * * * *', async () => {
  await checkOrderStatus();
});
```

---

## âœ… éªŒæ”¶æ¸…å•

### å¾®ä¿¡ç”Ÿæ€
- [ ] å…¬ä¼—å·è‡ªåŠ¨å›å¤æ­£å¸¸
- [ ] æ¨¡æ¿æ¶ˆæ¯æ¨é€æˆåŠŸ
- [ ] ä¼ä¸šå¾®ä¿¡å‘Šè­¦æ¨é€
- [ ] å°ç¨‹åºé¡µé¢åŠŸèƒ½æ­£å¸¸
- [ ] è§†é¢‘å·å†…å®¹åŒæ­¥

### ç”µå•†å¹³å°
- [ ] äº¬ä¸œå®¢æœè‡ªåŠ¨å›å¤
- [ ] æ·˜å®åƒç‰›æ™ºèƒ½æ¨è
- [ ] å•†å“æ•°æ®åŒæ­¥
- [ ] è®¢å•çŠ¶æ€åŒæ­¥
- [ ] è¯„ä»·è‡ªåŠ¨å›å¤

### æ•°æ®æ‰“é€š
- [ ] ç”¨æˆ·ç”»åƒç»Ÿä¸€
- [ ] è·¨å¹³å°æ¨èå‡†ç¡®
- [ ] æ•°æ®å®æ—¶åŒæ­¥
- [ ] æŠ¥è¡¨ç»Ÿè®¡å®Œæ•´

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### 1. å¾®ä¿¡å…¬ä¼—å·æ¥å£éªŒè¯å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥Tokené…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æœåŠ¡å™¨URLå¯è®¿é—®
- æŸ¥çœ‹ç­¾åç®—æ³•æ˜¯å¦æ­£ç¡®

### 2. ä¼ä¸šå¾®ä¿¡æ¶ˆæ¯æ¨é€å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥CorpIDå’ŒSecretæ˜¯å¦æ­£ç¡®
- ç¡®è®¤AgentIDé…ç½®
- æŸ¥çœ‹ç”¨æˆ·æƒé™è®¾ç½®

### 3. äº¬ä¸œAPIè°ƒç”¨é™æµ
**è§£å†³æ–¹æ¡ˆ**ï¼š
- å®ç°è¯·æ±‚é˜Ÿåˆ—
- æ·»åŠ ç¼“å­˜æœºåˆ¶
- å‡çº§APIå¥—é¤

### 4. å°ç¨‹åºäº‘å‡½æ•°è¶…æ—¶
**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¼˜åŒ–æŸ¥è¯¢é€»è¾‘
- å¢åŠ è¶…æ—¶æ—¶é—´é…ç½®
- ä½¿ç”¨å¼‚æ­¥å¤„ç†

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

**å¼€å‘æ–‡æ¡£**ï¼šæŸ¥çœ‹ `ğŸ“˜_æ™ºèƒ½ä½“å¤šå¹³å°æ•´åˆæ–¹æ¡ˆ_2025-12-17_v1.0.0.md`  
**ä»£ç ç¤ºä¾‹**ï¼š`server/integration/platformIntegration.js`  
**é—®é¢˜åé¦ˆ**ï¼štech@antom.com

---

**æœ€åæ›´æ–°**ï¼š2025-12-17  
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0.0
